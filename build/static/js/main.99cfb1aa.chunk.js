(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{193:function(e,t,n){e.exports=n(457)},198:function(e,t,n){},368:function(e,t){},370:function(e,t){},405:function(e,t){},406:function(e,t){},457:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(21),l=n.n(r),i=(n(198),n(41)),s=n(42),c=n(45),u=n(43),h=n(46),m=n(73),d=n(35),p=n(32),g=n(25),f=n(72),v=n.n(f),O=n(57),b=n.n(O),y=n(105),w=n.n(y),x=n(71),k=n.n(x),E=n(104),S=n.n(E),P=n(106),W=n.n(P),j={PaperProps:{style:{maxHeight:224,width:250}}},C=(Object(g.withStyles)(function(e){return{root:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing.unit,minWidth:120,maxWidth:300},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:e.spacing.unit/4},noLabel:{marginTop:3*e.spacing.unit}}})(function(e){var t=e.classes,n=e.handleSelect,a=e.selectedItem,r=e.items;return console.log(r),o.a.createElement(S.a,{className:t.formControl},o.a.createElement(w.a,{htmlFor:"select-multiple"},"Name"),o.a.createElement(W.a,{value:a,onChange:function(e){n(e.target.value)},input:o.a.createElement(b.a,{id:"select-multiple"}),MenuProps:j},r.map(function(e){return o.a.createElement(k.a,{key:e,value:e},e)})))}),n(44)),_=n.n(C),T=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.handleSelect,a=e.selectedItem,r=e.items,l=e.title,i=e.helperText;return o.a.createElement("div",{className:t.root},o.a.createElement(_.a,{id:"outlined-select-unit",select:!0,label:l,name:l.toLowerCase(),className:t.textField,value:a,onChange:n,SelectProps:{MenuProps:{className:t.menu}},helperText:i,margin:"normal",variant:"outlined"},r.map(function(e){return o.a.createElement(k.a,{key:e,value:e},e)})))}}]),t}(a.Component),I=Object(g.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0"},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},dense:{marginTop:16},menu:{width:200}}})(T),G=Object(g.withStyles)({root:{},textField:{margin:"0 0.5rem"}})(function(e){var t=e.classes,n=e.dimensions,a=e.handleChange,r=e.maxWidth,l=e.maxHeight;return console.log("dims:"),console.log(n),console.log("maxWidth maxHeight ".concat(r,"x").concat(l)),o.a.createElement("div",{className:t.root},o.a.createElement(_.a,{name:"width",type:"number",className:t.textField,variant:"outlined",label:"Width",onChange:a,value:n.width,inputProps:{min:0,max:r}}),o.a.createElement(_.a,{name:"height",type:"number",className:t.textField,variant:"outlined",label:"Height",value:n.height,onChange:a,inputProps:{min:0,max:l}}))}),R=function(e){return{type:"SET_FORM",payload:e}},F=function(e){return{type:"SELECT_WORKSHEET",payload:e}},N=n(31),K=n.n(N),M=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_handleChange",value:function(e){console.log(e.target);var t=Object(d.a)({},this.props.form);switch(e.target.name){case"units":case"width":case"height":t.dimensions[e.target.name]=e.target.value,this.props.setForm(t);break;case"worksheet":t.selectedWorksheet=e.target.value,this.props.setForm(t);break;case"pricegroup":t.selectedPriceGroup=e.target.value,this.props.setForm(t);break;default:console.log("unhandled "),console.log(e.target)}}},{key:"_calculateTotal",value:function(e,t){console.log("calculatin omsethin"),console.log(e),console.log(t);var n=-1,a=-1;if(t.length>0){var o=t.length,r=t[0].length;console.log("scanning ".concat(r,"x").concat(o));for(var l=0;l<o;l++)0===l?(console.log("Header col find:"),console.log(t[l].slice(1)),a=t[l].slice(1).findIndex(function(t){return parseInt(t)>=e.width})+1,console.log(a)):(console.log(t[l][0]),parseInt(t[l][0])>=e.height&&n<0&&(console.log("row find "+l),parseInt(t[l][0]),n=l));return console.log("found in ".concat(a,"x").concat(n)),console.log(t[a][n]),t[n][a]}return-1}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.form,a=e.workbook,r=[];if(console.log(n),console.log(a),"undefined"!==typeof a.Sheets[n.selectedWorksheet]){r=function(e,t){var n=K.a.utils.decode_range(e);console.log(n);var a,o,r,l=[];for(o=n.s.r;o<=n.e.r;o++){for(a=[],r=n.s.c;r<=n.e.c;r++){var i=t[K.a.utils.encode_cell({r:o,c:r})];"undefined"===typeof i?a.push(void 0):a.push(i.w)}l.push(a)}return l}("A5:S24",a.Sheets[n.selectedWorksheet]),console.log(r)}var l=this._calculateTotal(n.dimensions,r);return o.a.createElement("div",{className:t.root},o.a.createElement(v.a,{variant:"title"},"Interactive Pricing Form"),o.a.createElement("div",{className:t.column},o.a.createElement(G,{maxWidth:r[0]?r[0][r[0].length-1]:0,maxHeight:r[0]?r[r.length-1][0]:0,dimensions:n.dimensions,handleChange:this._handleChange.bind(this)}),o.a.createElement(I,{title:"Units",helperText:"Please select measurement unit",items:["inches","centimetres"],selectedItem:n.dimensions.units,handleSelect:this._handleChange.bind(this)})),o.a.createElement("div",{className:t.row},o.a.createElement(I,{title:"Worksheet",helperText:"Select a Worksheet",items:a.SheetNames.filter(function(e,t){return t%2===0}),selectedItem:this.props.form.selectedWorksheet,handleSelect:this._handleChange.bind(this)}),o.a.createElement(I,{title:"PriceGroup",helperText:"Select a Price Group",items:"Interlude"===this.props.form.selectedWorksheet?this.props.form.priceGroups.slice(0,4):this.props.form.priceGroups,selectedItem:this.props.form.selectedPriceGroup,handleSelect:this._handleChange.bind(this)})),o.a.createElement("div",null,o.a.createElement(v.a,{variant:"display1"},o.a.createElement("b",null,"Total:")," ",l," ")))}}]),t}(a.Component),B=Object(g.withStyles)({root:{padding:"0.5rem"},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",margin:"1rem 0"}})(Object(m.b)(function(e,t){return{form:e.form,workbook:e.workbook}},function(e,t){return Object(p.a)({selectWorksheet:F,setForm:R},e)})(M)),H={dimensions:{units:"inches",height:30,width:30},selectedWorksheet:"",worksheets:[],selectedPriceGroup:"PG1",priceGroups:["PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10"]},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"SET_FORM":return t.payload;case"WORKBOOK_IMPORT_SUCCESS":return Object(d.a)({},e,{selectedWorksheet:t.payload.SheetNames[0],worksheets:t.payload.SheetNames});case"SELECT_WORKSHEET":return Object(d.a)({},e,{selectedWorksheet:t.payload,activeSheet:e.worksheets.find(function(e){return e})});default:return e}},A={SheetNames:[],Sheets:[]},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"WORKBOOK_IMPORT_SUCCESS":return Object(d.a)({},t.payload);case"WORKBOOK_IMPORT_FAIL":return console.log("WORKBOOK_IMPORT_FAIL"),console.log(t.payload),e;default:return e}},D=Object(p.b)({form:L,workbook:U}),J=Object(p.c)(D),$=n(107),q=n.n($),z=n(192);function Q(){return(Q=Object(z.a)(q.a.mark(function e(t){var n,a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.next=3,fetch(t);case 3:return a=e.sent,e.next=6,a.blob();case 6:a=e.sent,n.onload=function(e){console.log(e);var t=e.target.result,n=K.a.read(t,{type:"binary"});J.dispatch({type:"WORKBOOK_IMPORT_SUCCESS",payload:n})},n.onerror=function(e){J.dispatch({type:"WORKBOOK_IMPORT_FAIL",payload:e})},n.readAsBinaryString(a);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var V=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){!function(e){Q.apply(this,arguments)}("./data/Price grids.xlsx")}},{key:"render",value:function(){return o.a.createElement(m.a,{store:J},o.a.createElement(B,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[193,2,1]]]);
//# sourceMappingURL=main.99cfb1aa.chunk.js.map