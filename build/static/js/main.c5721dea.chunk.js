(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{201:function(e,t,n){e.exports=n(473)},206:function(e,t,n){},386:function(e,t){},388:function(e,t){},423:function(e,t){},424:function(e,t){},473:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),l=n(21),r=n.n(l),c=(n(206),n(44)),s=n(45),i=n(49),h=n(46),u=n(48),d=n(73),p=n(26),m=n(37),g=n(33),f=n(25),v=n(47),O=n.n(v),b=n(196),w=n.n(b),S=n(36),y=n.n(S),k=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.handleSelect,a=e.selectedItem,l=e.items,r=e.title,c=e.helperText;return o.a.createElement("div",{className:t.root},o.a.createElement(y.a,{id:"outlined-select-unit",select:!0,label:r,name:r.toLowerCase(),className:t.textField,value:a,onChange:n,SelectProps:{MenuProps:{className:t.menu}},helperText:c,margin:"normal",variant:"outlined"},l.map(function(e){return o.a.createElement(w.a,{key:e,value:e},e)})))}}]),t}(a.Component),E=Object(f.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0"},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},dense:{marginTop:16},menu:{width:200}}})(k),x=Object(f.withStyles)({root:{},textField:{width:"5.5rem",margin:"0 0.5rem"}})(function(e){var t=e.classes,n=e.dimensions,a=e.handleChange,l=e.maxWidth,r=e.maxHeight;return console.log(l),console.log(r),o.a.createElement("div",{className:t.root},o.a.createElement(y.a,{name:"width",type:"number",className:t.textField,variant:"outlined",label:"Width",onChange:a,value:n.width,inputProps:{min:0,max:l}}),o.a.createElement(y.a,{name:"height",type:"number",className:t.textField,variant:"outlined",label:"Height",value:n.height,onChange:a,inputProps:{min:0,max:r}}))}),j=n(197),P=n.n(j),C=n(199),_=n.n(C),F=n(198),V=n.n(F),I=Object(f.withStyles)({root:{},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",alignItems:"center",margin:"1rem 0"},button:{margin:"0 1rem"}})(function(e){var t=e.classes,n=e.form,a=(e.workbook,e.handleChange);return console.log("v form"),console.log(n),o.a.createElement("div",null,o.a.createElement("div",{className:t.row},o.a.createElement(O.a,{variant:"title"},"Valence Options"),o.a.createElement(P.a,{name:"toggle-valance",className:t.button,variant:"fab",onClick:function(e){a({target:{name:"toggle-valance"}})}},n.showValance?o.a.createElement(V.a,null):o.a.createElement(_.a,null))),n.showValance&&o.a.createElement(E,{title:"Valance",helperText:"Please select valance option",items:n.valanceOptions,selectedItem:""!==n.selectedValanceOption?n.selectedValanceOption:n.valanceOptions[0],handleSelect:a}))}),W=function(e){return{type:"SET_FORM",payload:e}},G=function(e){return{type:"SELECT_WORKSHEET",payload:e}},T=n(32),R=n.n(T),A=function(e,t){var n=R.a.utils.decode_range(e);console.log(n);var a,o,l,r=[];for(o=n.s.r;o<=n.e.r;o++){for(a=[],l=n.s.c;l<=n.e.c;l++){var c=t[R.a.utils.encode_cell({r:o,c:l})];"undefined"===typeof c?a.push(void 0):a.push(c.v)}r.push(a)}return r},N=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(i.a)(this,Object(h.a)(t).call(this)))._handleChange=e._handleChange.bind(Object(m.a)(Object(m.a)(e))),e._calculateTotal=e._calculateTotal.bind(Object(m.a)(Object(m.a)(e))),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"_handleChange",value:function(e){console.log(e.target);var t=Object(p.a)({},this.props.form);switch(e.target.name){case"worksheet":t.selectedWorksheet=e.target.value,t.selectedValance="".concat(e.target.value.charAt(0).toUpperCase()," Valance"),this.props.setForm(t);break;case"pricegroup":t.selectedPriceGroup=e.target.value,this.props.setForm(t);break;case"toggle-valance":this.props.setForm(Object(p.a)({},t,{showValance:!t.showValance}));break;case"valance":t.selectedValanceOption=e.target.value,this.props.setForm(t);break;case"units":t.dimensions[e.target.name]=e.target.value,this.props.setForm(t);break;case"width":case"height":t.dimensions[e.target.name]=parseInt(e.target.value),this.props.setForm(t);break;default:console.log("unhandled "),console.log(e.target)}}},{key:"_calculateTotal",value:function(e,t,n){var a,o;console.log("calculatin omsethin"),console.log(e),console.log(t),console.log(n),"centimetres"===e.units?(a=parseFloat(.393701*e.width),o=parseFloat(.393701*e.width)):(a=parseFloat(e.width),o=parseFloat(e.height)),console.log("Calcuating for textile of width ".concat(a,"x").concat(o));var l=-1,r=-1,c=-1;if(t.length>0&&t[0].length>0){for(var s=t.length,i=(t[0].length,0);i<s;i++)0===i?r=t[i].slice(1).findIndex(function(e){return parseInt(e)>=a})+1:parseInt(t[i][0])>=o&&l<0&&(l=i);if(l<0)return console.log("No table match!"),-1;if(n.length>0){var h=n.length;n[0].length;console.log("Parsing header row of valance table"),console.log(n);var u=[];""===this.props.form.selectedValanceOption&&(this.props.form.selectedValanceOption=n[1][0]);for(i=1;i<h;i++)console.log(),console.log(n[i][0]+" compared to "+this.props.form.selectedValanceOption),u.push(n[i][0]),n[i][0]===this.props.form.selectedValanceOption&&(console.log("found col match: "+i),c=i);return this.props.form.valanceOptions=u,c<0?-1:(console.log(t[l][r]),console.log(n[c][r]),(parseFloat(t[l][r])+parseFloat(n[c][r])).toFixed(2))}return console.log("finding..."),console.log(l),console.log(r),parseFloat(t[l][r]).toFixed(2)}return-1}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.form,a=e.workbook,l=[],r=[];if(console.log(a),"undefined"!==typeof a.Sheets[n.selectedWorksheet]&&n.priceGroups.findIndex(function(e){return n.selectedPriceGroup})>-1){var c=n.priceGroups.findIndex(function(e){return e===n.selectedPriceGroup}),s=n.priceGroupMap[c];if(l=A(s,a.Sheets[n.selectedWorksheet]),n.showValance){console.log("fetching valance table...");var i=n.valances.findIndex(function(e){return e===n.selectedValance}),h=n.valanceMap[i];r=A(h,a.Sheets[n.selectedValance])}}var u=this._calculateTotal(n.dimensions,l,r);return console.log("units"),console.log(n.dimensions.units),o.a.createElement("div",{className:t.root},o.a.createElement(O.a,{variant:"title"},"Interactive Pricing Form"),o.a.createElement("div",{className:t.column},o.a.createElement(x,{maxWidth:l[0]?"inches"===n.dimensions.units?l[0][l[0].length-1]:l[0][l[0].length-1]/.393701:0,maxHeight:l[0]?"inches"===n.dimensions.units?l[l.length-1][0]:l[l.length-1][0]/.393701:0,dimensions:n.dimensions,handleChange:this._handleChange.bind(this)}),o.a.createElement(E,{title:"Units",helperText:"Please select measurement unit",items:["inches","centimetres"],selectedItem:n.dimensions.units,handleSelect:this._handleChange.bind(this)})),o.a.createElement("div",{className:t.row},o.a.createElement(E,{title:"Worksheet",helperText:"Select a Worksheet",items:a.SheetNames.filter(function(e,t){return t%2===0}),selectedItem:this.props.form.selectedWorksheet,handleSelect:this._handleChange.bind(this)}),o.a.createElement(E,{title:"PriceGroup",helperText:"Select a Price Group",items:"Interlude"===this.props.form.selectedWorksheet?this.props.form.priceGroups.slice(0,4):this.props.form.priceGroups,selectedItem:this.props.form.selectedPriceGroup,handleSelect:this._handleChange.bind(this)})),o.a.createElement(I,{form:n,workbook:a,handleChange:this._handleChange.bind(this)}),o.a.createElement("div",null,o.a.createElement(O.a,{variant:"display1"},o.a.createElement("b",null,"Total:")," ",u," ")))}}]),t}(a.Component),K=Object(f.withStyles)({root:{},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",margin:"1rem 0"}})(Object(d.b)(function(e,t){return{form:e.form,workbook:e.workbook}},function(e,t){return Object(g.a)({selectWorksheet:G,setForm:W},e)})(N)),M={dimensions:{units:"inches",height:30,width:30},selectedWorksheet:"",worksheets:[],selectedPriceGroup:"PG1",priceGroups:["PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10"],priceGroupMap:["A5:S24","A30:S49","A55:S74","A80:S99","A105:S124","A130:S149","A155:S174","A180:S199","A205:S224","A230:S249"],showValance:!1,selectedValance:"R Valance",valances:["R Valance","V Valance","I Valance"],valanceMap:["A1:S13","A1:S7","A1:S4"],selectedValanceOption:"",valanceOptions:[]},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"SET_FORM":return Object(p.a)({},e,t.payload);case"WORKBOOK_IMPORT_SUCCESS":return Object(p.a)({},e,{selectedWorksheet:t.payload.SheetNames[0],worksheets:t.payload.SheetNames});case"SELECT_WORKSHEET":return Object(p.a)({},e,{selectedWorksheet:t.payload,selectedValance:"".concat(t.payload.charCodeAt(0).toUpperCase()," Valance"),activeSheet:e.worksheets.find(function(e){return e})});default:return e}},L={SheetNames:[],Sheets:[]},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"WORKBOOK_IMPORT_SUCCESS":return Object(p.a)({},e,t.payload);case"WORKBOOK_IMPORT_FAIL":return console.log("WORKBOOK_IMPORT_FAIL"),console.log(t.payload),e;default:return e}},H=Object(g.b)({form:B,workbook:U}),D=Object(g.c)(H),J=n(106),$=n.n(J),q=n(200);function z(){return(z=Object(q.a)($.a.mark(function e(t){var n,a;return $.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.next=3,fetch(t);case 3:return a=e.sent,e.next=6,a.blob();case 6:a=e.sent,n.onload=function(e){console.log(e);var t=e.target.result,n=R.a.read(t,{type:"binary"});D.dispatch({type:"WORKBOOK_IMPORT_SUCCESS",payload:n})},n.onerror=function(e){D.dispatch({type:"WORKBOOK_IMPORT_FAIL",payload:e})},n.readAsBinaryString(a);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Q=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){!function(e){z.apply(this,arguments)}("./data/Price grids.xlsx")}},{key:"render",value:function(){return o.a.createElement(d.a,{store:D},o.a.createElement(K,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[201,2,1]]]);
//# sourceMappingURL=main.c5721dea.chunk.js.map