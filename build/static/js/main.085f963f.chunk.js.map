{"version":3,"sources":["theme/index.js","components/RoomPanel.js","components/WindowPanel.js","components/OutlinedDropdown.js","components/WidthHeightTextInput.js","components/AddValanceOption.js","actions/form.js","methods/index.js","components/TextileForm.js","store/form.js","store/workbook.js","store/formSagas.js","store/index.js","ExcelToJSON.js","App.js","serviceWorker.js","index.js"],"names":["theme","createMuiTheme","palette","type","RoomPanel","_this$props","this","props","classes","handleClick","handleChange","rooms","selectedRoom","react_default","a","createElement","className","root","classNames","row","descriptionField","Typography_default","typography","variant","style","maxWidth","textAlign","Fab_default","fab","onClick","id","size","Add_default","e","target","Tabs_default","value","onChange","v","indicatorColor","textColor","scrollButtons","centered","map","r","Tab_default","key","label","name","container","display","alignItems","TextField_default","textField","nameField","disabled","length","Remove_default","description","Component","withStyles","margin","flexDirection","height","width","minWidth","justifyContent","withTheme","WindowPanel","windows","selectedWindow","console","log","OutlinedDropdown","str","replace","toUpperCase","selectedItem","hidden","items","title","helperText","toLowerCase","select","_camelToNormal","SelectProps","MenuProps","menu","autoWidth","item","MenuItem_default","flexWrap","marginLeft","spacing","unit","marginRight","dense","marginTop","dimensions","maxHeight","inputProps","min","max","column","button","form","window","valanceOptions","selectedValanceOption","showValance","components_OutlinedDropdown","handleSelect","downloadFormRequested","payload","setForm","newForm","selectWorksheet","worksheet","parseTableFromRange","rangeString","sheet","range","XLSX","utils","decode_range","rowNum","colNum","activeTable","s","c","nextCell","encode_cell","push","TextileForm","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","_handleChange","bind","assertThisInitialized","_calculateTotal","_calculateGrandTotal","formCopy","objectSpread","showMotorization","selectedMotorization","clientName","selectedHem","selectedBlindType","selectedFabric","selectedPriceGroup","fabricToPriceGroupMapping","parseInt","_printForm","splice","shortid","generate","concat","units","total","dim","at","vt","textileWidthInInches","textileHeightInInches","parseFloat","findRow","findCol","findVRow","tableHeight","i","slice","findIndex","tempOptions","toFixed","grandTotal","reduce","w","r2","toConsumableArray","sum","copy","preppedWindows","forEach","ValanceOption","MotorizationOption","Fabric","PriceGroup","projectId","_this2","workbook","valanceTable","Sheets","priceGroups","pg","index","priceGroupMap","selectedValance","vindex","valances","valanceRangeString","valanceMap","windowTotal","components_RoomPanel","_handleClick","components_WindowPanel","WidthHeightTextInput","SheetNames","filter","keys","hembars","InputLabel_default","Checkbox_default","checked","motorizations","AddValanceOption","toString","IconButton_default","color","aria-label","CloudDownload_default","padding","connect","state","ownProps","dispatch","bindActionCreators","initialState","worksheets","Cottonwood","Linen","Vinyl 4 Ply","Bali","Boardwalk","CS 103","CS 105","Gabardine","Merino","Petals","Satin Privacy","Wool Privacy","York_solid","CS 101","Denim Privacy","DX 201","EZ 900","Glow","Lattice Translucent","Matisse","Water Colour","Berber","Bling","Earth 2","Flicker Translucent","Lavish","Reed","Vinyl Wideshade","Lattice Opaque","Mist","Wool Opaque","Apex View 4-5%","Denim Opaque","ELT 303","EPT 301","Rococo","Satin Opaque","Apex View 2-3%","Apex Reflect 2-3%","Basket Privacy","Matrix 2%","Z Splendor","Summit Privacy","Wave","Flicker Opaque","Summit Reflect","Paper","Trilogy","Apex Opaque","Basket Opaque","Bubble","CSR 103","priceGroupToValenceMapping","PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10","arguments","undefined","action","charCodeAt","activeSheet","find","ws","handleFormDownloadSaga","downloadFormRequestedSaga","createAndDownloadFile","_callee","parsedFormObj","fileText","doc","paragraph","packer","regenerator_default","wrap","_context3","prev","next","prettyjson","render","keysColor","dashColor","stringColor","Document","Paragraph","addParagraph","Packer","toBase64String","sent","download","abrupt","t0","stop","_context","put","_marked","_context2","takeEvery","_marked2","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","enhancers","middleware","rootReducer","combineReducers","sagaMiddleware","createSagaMiddleware","applyMiddleware","apply","enhancer","createStore","run","fileUrl","reader","fileBlob","FileReader","fetch","blob","onload","data","result","read","store","onerror","ex","readAsBinaryString","App","_x","_ref","ExcelToJSON","es","styles","components_TextileForm","Boolean","location","hostname","match","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.085f963f.chunk.js","sourcesContent":["import {createMuiTheme} from '@material-ui/core/styles/';\n\nconst theme = createMuiTheme({\n  palette: {\n    type: 'light',\n  },\n});\n\nexport default theme;\n","import React, {Component} from 'react';\nimport classNames from 'classnames';\n\nimport Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    maxWidth:'48rem'\n\n  },\n  container:{\n    display:'flex',\n    flexDirection:'column',\n    margin: '0.5rem 0rem 0.5rem 0rem'\n  },\n  nameField:{\n    maxWidth:'8rem'\n  },\n  descriptionField:{\n    maxWidth:'32rem'\n  },\n  fab: {\n    //margin:theme.spacing.unit,\n    height:'2rem',\n    width:'2rem',\n    minWidth:'1rem'\n  },\n  textField:{\n    margin:'0 0.5rem 0 0.5rem'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    justifyContent:'space-between'\n  }\n})\n\n\n\nclass RoomPanel extends Component {\n\n  render(){\n    const {classes, handleClick, handleChange, rooms, selectedRoom} = this.props;\n    return (\n      <div className={classes.root} >\n        <div className={classNames(classes.row, classes.descriptionField)}>\n          <Typography className={classes.typography} variant=\"subtitle1\">Rooms</Typography>\n\n            <div style={{ maxWidth:'12rem', textAlign:'center'}}>\n              <Typography variant=\"subtitle2\">Add a room</Typography>\n              <Fab className={classes.fab} onClick={handleClick} id=\"add-room\" size=\"small\">\n                <AddIcon onClick={(e)=>handleClick({target:{id:'add-room'}})}></AddIcon>\n              </Fab>\n            </div>\n\n          </div>\n        {/*rooms.find(r=>r.name===selectedRoom).name*/}\n        <Tabs\n            value={selectedRoom}\n            onChange={(e,v)=>handleChange({target:{id:'selectedRoom'}},v)}\n\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            variant=\"scrollable\"\n            scrollButtons=\"auto\"\n            centered={false}\n          >\n            {rooms.map(r=>(\n              <Tab key={r.id} id=\"selectedRoom\" label={r.name} />))\n            }\n          </Tabs>\n           <div className={classes.container}>\n               <div className={classes.row}>\n                 <div style={{display:'flex', alignItems:'center'}}>\n                  <TextField\n                    className={classNames(classes.textField, classes.nameField)}\n                    id=\"room-name\"\n                    label=\"Name\"\n                    value={rooms[selectedRoom].name}\n                    onChange={handleChange}\n                    />\n                  <Fab className={classes.fab} disabled={rooms.length < 2} onClick={handleClick} id=\"remove-room\" size=\"small\">\n                    <RemoveIcon onClick={(e)=>handleClick({target:{id:'remove-room'}})}></RemoveIcon>\n                  </Fab>\n                  </div>\n              </div>\n              <TextField\n                id=\"room-description\"\n                className={classNames(classes.textField, classes.descriptionField)}\n                label=\"Description\"\n                value={rooms[selectedRoom].description}\n                onChange={handleChange}\n                />\n           </div>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles, {withTheme:true})(RoomPanel)\n","import React, {Component} from 'react';\nimport classNames from 'classnames';\n\nimport Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    maxWidth:'32rem'\n\n  },\n  container:{\n    display:'flex',\n    flexDirection:'column',\n    margin: '0.5rem 0rem 0.5rem 0rem'\n  },\n  nameField:{\n    maxWidth:'8rem'\n  },\n  descriptionField:{\n    maxWidth:'32rem'\n  },\n  fab: {\n    //margin:theme.spacing.unit,\n    height:'2rem',\n    width:'2rem',\n    minWidth:'1rem'\n  },\n  textField:{\n    margin:'0 0.5rem 0 0.5rem'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    justifyContent:'space-between'\n  }\n})\n\n\n\n\nclass WindowPanel extends Component {\n\n  render(){\n    const {classes, handleClick, handleChange, windows, selectedWindow} = this.props;\n    return (\n      <div className={classes.root} >\n        <div className={classes.row}>\n          <Typography className={classes.typography} variant=\"subtitle1\">Windows</Typography>\n\n            <div style={{maxWidth:'12rem', textAlign:'center'}}>\n              <Typography variant=\"subtitle2\">Add a window</Typography>\n              <Fab className={classes.fab} onClick={handleClick} id=\"add-window\" size=\"small\">\n                <AddIcon onClick={(e)=>handleClick({target:{id:'add-window'}})}></AddIcon>\n              </Fab>\n            </div>\n\n          </div>\n\n        {/*rooms.find(r=>r.name===selectedRoom).name*/}\n        <Tabs\n            value={selectedWindow}\n            onChange={(e,v)=>handleChange({target:{id:'selectedWindow'}},v)}\n\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            variant=\"scrollable\"\n            scrollButtons=\"auto\"\n\n          >\n            {windows.map(r=>(\n              <Tab key={r.id} onClick={e=>console.log(e.target)} label={r.name} />))\n            }\n          </Tabs>\n          <div className={classes.container}>\n              <div className={classes.row}>\n                 <div style={{display:'flex', alignItems:'center'}}>\n                   <TextField\n                     className={classNames(classes.textField, classes.nameField)}\n                     id=\"window-name\"\n                     label=\"Name\"\n                     value={windows[selectedWindow].name}\n                     onChange={handleChange}\n                     />\n\n                   <Fab className={classes.fab} onClick={handleClick} disabled={windows.length < 2} id=\"remove-window\" size=\"small\">\n                    <RemoveIcon onClick={(e)=>handleClick({target:{id:'remove-window'}})}></RemoveIcon>\n                   </Fab>\n                 </div>\n\n             </div>\n             <TextField\n               id=\"window-description\"\n               className={classNames(classes.textField, classes.descriptionField)}\n               label=\"Description\"\n               value={windows[selectedWindow].description}\n               onChange={handleChange}\n               />\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles)(WindowPanel)\n","import React, {Component} from 'react';\n\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    minWidth:'8rem',\n    maxWidth:'12rem'\n  },\n  hidden:{\n    display:'none'\n  },\n  container: {\n   display: 'flex',\n   flexWrap: 'wrap',\n },\n textField: {\n   marginLeft: theme.spacing.unit,\n   marginRight: theme.spacing.unit,\n },\n dense: {\n   marginTop: 16,\n },\n menu: {\n   //width: 200,\n },\n})\n\n\n\nclass OutlinedDropdown extends Component {\n  _camelToNormal(str){\n    return str\n    // insert a space before all caps\n     .replace(/([A-Z])/g, ' $1')\n     // uppercase the first character\n     .replace(/^./, function(str){ return str.toUpperCase(); });\n  }\n  render(){\n    const {classes, handleChange, selectedItem, hidden, items, title, helperText} = this.props;\n    console.log(handleChange)\n    return (\n      <div className={ hidden ? classes.hidden : classes.root}>\n        <TextField\n         id={title.toLowerCase()}\n         select\n         label={this._camelToNormal(title)}\n         name={title.toLowerCase()}\n         className={classes.textField}\n         value={selectedItem}\n         onChange={ e=>handleChange({target:{id:title.toLowerCase(), value:e.target.value}}) }\n         SelectProps={{\n           id:title.toLowerCase(),\n           MenuProps: {\n             className: classes.menu,\n           },\n           autoWidth:true\n         }}\n         helperText={helperText}\n         margin=\"normal\"\n         variant=\"outlined\"\n       >\n         {items.map(item => (\n           <MenuItem id={title.toLowerCase()}\n             key={item} value={item}>\n             {item}\n           </MenuItem>\n         ))}\n       </TextField>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles)(OutlinedDropdown)\n","\nimport React, {Component} from 'react';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n\nconst styles = {\n    root:{\n\n    },\n    textField:{\n      width:'5.5rem',\n      margin:'0 0.5rem'\n    }\n}\n\nexport default withStyles(styles)((props) => {\n    const {classes, dimensions, handleChange, maxWidth, maxHeight} = props;\n    console.log(maxWidth)\n    console.log(maxHeight)\n    return (\n    <div className={classes.root}>\n        <TextField\n          title=\"width\"\n          id=\"width\"\n          type=\"number\"\n          className={classes.textField}\n          variant=\"outlined\"\n          label=\"Width\"\n          onChange={handleChange}\n          value={dimensions.width}\n          inputProps={{\n             min:0,\n             max:maxWidth\n           }}/>\n        <TextField\n          title=\"height\"\n          id=\"height\"\n          type=\"number\"\n          className={classes.textField}\n          variant=\"outlined\"\n          label=\"Height\"\n          value={dimensions.height}\n          onChange={handleChange}\n          inputProps={{\n             min:0,\n             max:maxHeight\n           }}\n        />\n    </div>\n    )\n})\n","import React, {Component} from 'react';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n//import Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\n\nimport OutlinedDropdown from './OutlinedDropdown'\n\nconst styles = {\n  root:{\n\n  },\n  column:{\n    display:'flex',\n    flexDirection:'column',\n    margin:'1rem 0'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    margin:'1rem 0'\n  },\n  button:{\n    margin:'0 1rem'\n  }\n}\nexport default withStyles(styles)((props)=>{\n  const {classes, disabled, form, window, handleChange} = props\n  console.log(\"v form\")\n  console.log(form.valanceOptions)\n  console.log(window.selectedValanceOption)\n  console.log(disabled)\n  return (\n    <div>\n      <div className={classes.row}>\n        <Typography variant=\"subtitle1\">Valence Options</Typography>\n        <Fab id=\"toggle-valance\" disabled={disabled} className={classes.button} onClick={handleChange}>\n          {window.showValance ? <RemoveIcon\n              onClick={(e)=>{handleChange({target:{id:'toggle-valance', value:e.target.value}})}}\n            ></RemoveIcon>:\n            <AddIcon\n              onClick={(e)=>{handleChange({target:{id:'toggle-valance', value:e.target.value}})}}\n              ></AddIcon>}\n        </Fab>\n      </div>\n      {window.showValance &&\n        <OutlinedDropdown\n          title=\"Valance\"\n          id=\"valance-option\"\n          helperText=\"Please select valance option\"\n          handleChange={handleChange}\n          items={form.valanceOptions}\n          selectedItem={window.selectedValanceOption !== \"\" ? window.selectedValanceOption : form.valanceOptions[0]}\n          handleSelect={handleChange}\n          />\n      }\n    </div>\n\n  )\n})\n","export const SELECT_WORKSHEET = 'SELECT_WORKSHEET';\nexport const SET_FORM = 'SET_FORM';\nexport const DOWNLOAD_FORM_REQUESTED = 'DOWNLOAD_FORM_REQUESTED';\n\nexport const downloadFormRequested = (form) => {\n    return {\n        type: DOWNLOAD_FORM_REQUESTED,\n        payload: form\n    }\n}\n\nexport const setForm = (newForm) => {\n    return {\n        type: SET_FORM,\n        payload: newForm\n    }\n}\nexport const selectWorksheet = (worksheet) => {\n    return {\n        type: SELECT_WORKSHEET,\n        payload: worksheet\n    }\n}\n","import XLSX from 'xlsx';\n\nexport const parseTableFromRange = (rangeString, sheet) => {\n     const range = XLSX.utils.decode_range(rangeString);\n     console.log(range)\n     var activeTable = [];\n     var result = [];\n     var row;\n     var rowNum;\n     var colNum;\n     //var range = XLSX.utils.decode_range(sheet['!ref']);\n     for(rowNum = range.s.r; rowNum <= range.e.r; rowNum++){\n        row = [];\n         for(colNum=range.s.c; colNum<=range.e.c; colNum++){\n            var nextCell = sheet[\n               XLSX.utils.encode_cell({r: rowNum, c: colNum})\n            ];\n            if( typeof nextCell === 'undefined' ){\n               row.push(void 0);\n            } else row.push(nextCell.v);\n         }\n         activeTable.push(row);\n     }\n\n     return activeTable;\n}\n","import React, {Component} from 'react';\n\nimport { connect } from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport RoomPanel from './RoomPanel';\nimport WindowPanel from './WindowPanel';\nimport OutlinedDropdown from './OutlinedDropdown';\n\n\nimport WidthHeightTextInput from './WidthHeightTextInput';\nimport AddValanceOption from './AddValanceOption'\n\n\nimport {downloadFormRequested, selectWorksheet, setForm} from '../actions/form';\nimport {parseTableFromRange} from '../methods';\nimport shortid from 'shortid';\n\n\n\n//import officegen from 'officegen';\n\n\n//UNIT CONVERSION\nconst CM_TO_INCH=0.393701;\n\nconst styles = theme => ({\n  button: {\n    margin: theme.spacing.unit,\n  },\n  root:{\n    padding:'1rem'\n  },\n  column:{\n    display:'flex',\n    flexDirection:'column',\n    margin:'1rem 0'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    margin:'1rem 0',\n    //alignItems:'center'\n  },\n  typography:{\n    margin:'0.5rem 0 0.5rem 0'\n  }\n})\n\nclass TextileForm extends Component {\n  constructor(){\n    super();\n    this._handleChange = this._handleChange.bind(this)\n    this._calculateTotal = this._calculateTotal.bind(this)\n    this._calculateGrandTotal = this._calculateGrandTotal.bind(this)\n\n  }\n  _handleChange(e, v) {\n    console.log(e.target.id)\n    console.log(e.target.value)\n    console.log(v)\n    let formCopy = {...this.props.form}\n    //let thisWindow = formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow];\n    switch(e.target.id) {\n      case \"show-motorization\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showMotorization = !formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showMotorization;\n        this.props.setForm(formCopy)\n        break;\n      case \"selectedmotorization\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedMotorization = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"client-name\":\n        formCopy.clientName = e.target.value\n        this.props.setForm(formCopy)\n        break;\n      case \"window-name\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].name = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"window-description\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].description = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"room-name\":\n        formCopy.rooms[formCopy.selectedRoom].name = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"room-description\":\n        formCopy.rooms[formCopy.selectedRoom].description = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"selectedRoom\":\n        formCopy.selectedRoom = v;\n        formCopy.selectedWindow = 0; //must reset incase out of index of new windows array!\n        this.props.setForm(formCopy)\n        break;\n      case \"selectedWindow\":\n        formCopy.selectedWindow = v;\n        this.props.setForm(formCopy)\n        break;\n      case \"selectedhem\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedHem = e.target.value\n        this.props.setForm(formCopy)\n        break;\n      case \"blindtype\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedBlindType = e.target.value\n        //formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedValanceOption = `${e.target.value.charAt(0).toUpperCase()} Valance`\n        this.props.setForm(formCopy)\n        break;\n      case \"fabric\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedFabric = e.target.value;\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedPriceGroup = formCopy.fabricToPriceGroupMapping[e.target.value];\n        this.props.setForm(formCopy)\n        break;\n      case \"pricegroup\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedPriceGroup = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"toggle-valance\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showValance = !formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showValance\n        //formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedValanceOption = 'R Valance'\n        this.props.setForm(formCopy)\n        break;\n      case \"valance\":\n        console.log(\"valence ch ange!\")\n        console.log(formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow])\n        console.log(e.target.value)\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedValanceOption = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"units\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].dimensions[e.target.id] = e.target.value;\n        this.props.setForm(formCopy)\n        break;\n      case \"width\":\n      case \"height\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].dimensions[e.target.id] = parseInt(e.target.value);\n        this.props.setForm(formCopy)\n        break;\n      default:\n        console.log(\"unhandled \")\n        console.log(e.target)\n    }\n  }\n  _handleClick(e, v){\n    console.log(e.target.id)\n    let formCopy = {...this.props.form}\n\n    switch(e.target.id) {\n      case \"download-form\":\n        this.props.downloadFormRequested(this._printForm(formCopy));\n        break;\n      case \"remove-room\":\n        formCopy.rooms.splice(formCopy.selectedRoom,1);\n        formCopy.selectedRoom = 0;\n        formCopy.selectedWindow = 0;\n        this.props.setForm(formCopy)\n\n        break;\n      case \"remove-window\":\n        formCopy.rooms[formCopy.selectedRoom].windows.splice(formCopy.selectedWindow,1);\n        formCopy.selectedWindow = 0;\n        this.props.setForm(formCopy)\n\n        break;\n      case \"add-room\":\n        formCopy.rooms.push({\n          id:shortid.generate(),\n          name:`Room ${formCopy.rooms.length+1}`,\n          description: ``,\n          windows:[{\n            id:shortid.generate(),\n            name:`Window ${formCopy.rooms[formCopy.selectedRoom].windows.length}`,\n            description: ``,\n            dimensions: {\n              units: 'inches',\n              height: 30,\n              width: 30\n            },\n            selectedValanceOption:'Decora 8',\n            selectedBlindType:'Roller',\n            selectedFabric:'Cottonwood',\n            selectedPriceGroup:'PG1',\n            showValance:false,\n            total:155.95,\n          },]\n        })\n        this.props.setForm(formCopy)\n\n        break;\n      case \"add-window\":\n        formCopy.rooms[formCopy.selectedRoom].windows.push({\n          id:shortid.generate(),\n          name:`Window ${formCopy.rooms[formCopy.selectedRoom].windows.length+1}`,\n          description: ``,\n          dimensions: {\n            units: 'inches',\n            width:30,\n            height:30\n          },\n          selectedValanceOption:'Decora 8',\n          selectedBlindType:'Roller',\n          selectedFabric:'Cottonwood',\n          selectedPriceGroup:'PG1',\n          showValance:false,\n          total:155.95\n        })\n        this.props.setForm(formCopy)\n\n        break;\n      default:\n        console.log(\"unhandled \" + e.target.id)\n    }\n  }\n  _calculateTotal(dim, at, vt) {\n    //this is bound to the scope!\n    console.log(\"calculatin \")\n    console.log(dim)\n    console.log(at)\n    console.log(vt)\n\n    let textileWidthInInches;\n    let textileHeightInInches;\n    if(dim.units === 'centimetres') {\n      textileWidthInInches = parseFloat(CM_TO_INCH*dim.width)\n      textileHeightInInches = parseFloat(CM_TO_INCH*dim.width)\n    } else {\n      textileWidthInInches = parseFloat(dim.width)\n      textileHeightInInches = parseFloat(dim.height)\n    }\n    console.log(`Calcuating for textile of width ${textileWidthInInches}x${textileHeightInInches}`)\n    //LOOKUP TABLES\n    let findRow = -1;\n    let findCol = -1;\n    let findVRow = -1;\n    let findVCol = -1;\n\n    if(at.length > 0 && at[0].length > 0 ) {\n      const tableHeight = at.length;  //rows\n      const tableWidth = at[0].length; //\n\n      for(var i=0; i<tableHeight; i++){\n        //ignore 0,0\n        if(i===0) {\n          //scan header row on first iteration\n          findCol = at[i].slice(1).findIndex(c=>parseInt(c)>=textileWidthInInches)+1;\n        } else {\n          //scans first element of each row on subsequent\n          if( parseInt(at[i][0])>=textileHeightInInches && findRow < 0) {\n            //parseInt(at[i][0])\n            findRow=i\n          }\n        }\n      }\n\n      if(findRow < 0) {\n        console.log(\"No table match!\")\n        return -1\n      }\n\n      if(vt.length > 0) {\n        //we know it will be in the same ColNumber, we just need to match the row\n        const tableHeight = vt.length;  //rows\n        const tableWidth = vt[0].length; //\n        //console.log(\"Parsing header row of valance table\")\n        //console.log(vt)\n        let tempOptions = []\n\n        //TODO: dont do this!\n        //if(this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption === '') this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption = vt[1][0]\n        console.log(\"making valance tables\")\n        console.log(tableHeight)\n        console.log(vt)\n        for(var i =1; i< tableHeight; i++ ) {\n          //console.log()\n          //console.log(vt[i][0] + \" compared to \" + this.props.form.selectedValanceOption)\n          tempOptions.push(vt[i][0])\n          if(vt[i][0] === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption){\n            //console.log(\"found col match: \" + i)\n            findVRow = i;\n          }\n        }\n        this.props.form.valanceOptions = tempOptions  //TODO: dont do this...update the valanceOptions on the form\n\n        //may not find row match if new worksheet\n\n        if(findVRow < 0) return -1\n        //width is assumed, same findCol\n\n        return (parseFloat(at[findRow][findCol])+parseFloat(vt[findVRow][findCol])).toFixed(2)\n      } else {\n\n        return (parseFloat(at[findRow][findCol])).toFixed(2);\n      }\n\n\n    }\n    return -1;\n  }\n  _calculateGrandTotal(){\n    console.log(\"rooms\")\n    console.log(this.props.form.rooms)\n    let windows = []\n    let grandTotal = -1;\n    if(this.props.form.rooms.length > 1) {\n      windows = this.props.form.rooms.reduce((w,r2)=>{\n        return [...w, ...r2.windows];\n      }, []);\n    } else {\n      windows = this.props.form.rooms[0].windows;\n      //grandTotal = windowTotal\n    }\n    console.log(\"the windows!\")\n    console.log(windows)\n    console.log(\"GT:\")\n    grandTotal = windows.reduce((sum,w)=>sum+w.total, 0)\n    console.log(grandTotal)\n    return  grandTotal;\n  }\n\n  _printForm(form) {\n    var text = ``;\n    var copy = {...form}\n    var preppedWindows = [];\n\n    copy.rooms.forEach((r,i)=>{\n      r.windows.forEach(w=> {\n\n        if(w.showValance) {\n          w.ValanceOption = w.selectedValanceOption;\n        }\n        if(w.showMotorization) {\n          w.MotorizationOption = w.selectedMotorization;\n        }\n        w.Fabric = w.selectedFabric;\n        w.PriceGroup = w.selectedPriceGroup;\n\n        delete w.id;\n        delete w.showValance;\n        delete w.showMotorization;\n        delete w.selectedMotorization;\n        delete w.selectedValanceOption;\n        delete w.selectedFabric;\n        preppedWindows.push({\n          ...w,\n          name:`${r.name}-${w.name}`,\n        });\n      }) });\n\n    return {\n      projectId: form.projectId,\n      clientName: form.clientName,\n      windows:preppedWindows,\n      grandTotal: this._calculateGrandTotal(),\n    }\n  }\n\n  render () {\n    const {classes, form, workbook} = this.props\n    let activeTable = []\n    let valanceTable = []\n    console.log(\"workbook:\")\n    console.log(workbook)\n\n    if(typeof workbook.Sheets[form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType] !== 'undefined' && form.priceGroups.findIndex(pg=>form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedPriceGroup) > -1) {\n      const index = form.priceGroups.findIndex(pg=>pg===form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedPriceGroup);\n      const rangeString = form.priceGroupMap[index]\n\n      activeTable = parseTableFromRange(rangeString, workbook.Sheets[form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType])\n\n      if(form.rooms[form.selectedRoom].windows[form.selectedWindow].showValance) {\n        console.log(\"fetching valance table...\")\n        console.log(form.selectedValance)\n        const vindex = form.valances.findIndex(v=>v===form.selectedValance)\n        console.log(vindex)\n        const valanceRangeString = form.valanceMap[vindex]\n        console.log(valanceRangeString)\n        valanceTable = parseTableFromRange(valanceRangeString, workbook.Sheets[form.selectedValance]);\n      }\n\n    }\n\n    //var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);\n    //   var json_object = JSON.stringify(XL_row_object);\n\n    const windowTotal = this._calculateTotal(form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions, activeTable, valanceTable);\n    form.rooms[form.selectedRoom].windows[form.selectedWindow].total = parseFloat(windowTotal);  //hardset formstate\n\n    const grandTotal = this._calculateGrandTotal();\n\n    return (\n        <div className={classes.root}>\n          <Typography className={classes.typography} variant=\"title\">Interactive Pricing Form</Typography>\n          <Typography className={classes.typography} variant=\"subtitle1\">Project Id.: {form.projectId}</Typography>\n          <TextField id=\"client-name\" label=\"Client Name\" value={form.clientName} onChange={this._handleChange.bind(this)}/>\n\n          <div className={classes.column}>\n            <RoomPanel handleClick={this._handleClick.bind(this)} handleChange={this._handleChange.bind(this)} rooms={form.rooms} selectedRoom={form.selectedRoom}/>\n            <WindowPanel handleClick={this._handleClick.bind(this)} handleChange={this._handleChange.bind(this)} windows={form.rooms[form.selectedRoom].windows} selectedWindow={form.selectedWindow}/>\n\n          </div>\n          <div>\n            <Typography variant=\"display1\">Window Properties</Typography>\n          </div>\n          <div className={classes.column}>\n            <Typography className={classes.typography} variant=\"subtitle1\">Dimensions and Units</Typography>\n\n            <WidthHeightTextInput\n              maxWidth={activeTable[0] ? ( form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions.units==='inches' ? activeTable[0][activeTable[0].length-1] : activeTable[0][activeTable[0].length-1]/CM_TO_INCH) : 0}\n              maxHeight={activeTable[0] ? ( form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions.units==='inches' ? activeTable[activeTable.length-1][0] : activeTable[activeTable.length-1][0]/CM_TO_INCH) : 0}\n              dimensions={form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions}\n              handleChange={this._handleChange.bind(this)}\n              />\n            <OutlinedDropdown\n              title=\"Units\"\n              helperText=\"Please select measurement unit\"\n              items={[\"inches\", \"centimetres\"]}\n              selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions.units}\n              handleChange={this._handleChange.bind(this)}/>\n\n          </div>\n\n          <Typography className={classes.typography} variant=\"subtitle1\">Fabric</Typography>\n\n          {/*Work Sheets Select*/\n\n            (<div className={classes.row}>\n                <OutlinedDropdown\n                  title=\"BlindType\"\n                  helperText=\"Select a Blind Type\"\n                  items={workbook.SheetNames.filter(((a,i)=>i%2===0))}\n                  selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType}\n                  handleChange={this._handleChange.bind(this)}/>\n                <OutlinedDropdown\n                  title=\"Fabric\"\n                  helperText=\"Select a Fabric\"\n                  items={/*this.props.form.selectedBlindType === 'Interlude' ? this.props.form.priceGroups.slice(0,4) : this.props.form.priceGroups*/\n                    Object.keys(form.fabricToPriceGroupMapping)\n                  }\n                  selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedFabric}\n                  handleChange={this._handleChange.bind(this)}/>\n                <OutlinedDropdown\n                  title=\"PriceGroup\"\n                  helperText=\"Select a Price Group\"\n                  hidden={true}\n                  items={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType === 'Interlude' ? form.priceGroups.slice(0,4) : form.priceGroups}\n                  selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedPriceGroup}\n                  handleChange={this._handleChange.bind(this)}/>\n              </div>)\n          }\n\n\n          <div>\n            <Typography variant=\"subtitle1\">Hem Options </Typography>\n          </div>\n          <OutlinedDropdown\n            title=\"SelectedHem\"\n            helperText=\"Select a Hembar type\"\n            items={form.hembars}\n            selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedHem}\n            handleChange={this._handleChange.bind(this)}/>\n\n        {/* Motorization Panel*/}\n          <div>\n            <InputLabel>Motorization</InputLabel>\n            <Checkbox\n              id=\"show-motorization\"\n              checked={form.rooms[form.selectedRoom].windows[form.selectedWindow].showMotorization}\n              onChange={this._handleChange.bind(this)}\n              value={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedMotorization}\n            />\n            {\n              form.rooms[form.selectedRoom].windows[form.selectedWindow].showMotorization && (\n                  <OutlinedDropdown\n                    title=\"selectedMotorization\"\n                    helperText=\"Select a Motorization type\"\n                    items={form.motorizations}\n                    selectedItem={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedMotorization}\n                    handleChange={this._handleChange.bind(this)}/>)\n            }\n          </div>\n\n          <AddValanceOption\n            form={form}\n            disabled={form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType === 'Vision' ? true : false}\n            window={form.rooms[form.selectedRoom].windows[form.selectedWindow]}\n            handleChange={this._handleChange.bind(this)}/>\n\n          <div>\n            <Typography variant=\"display1\"><b>Current Window Total:</b> {windowTotal} </Typography>\n          </div>\n          <div className={classes.row}>\n            <Typography variant=\"display2\"><b>Total:</b> {\n              grandTotal.toFixed(2).toString()\n          } </Typography>\n          <IconButton id=\"download-form\" disabled={windowTotal === -1} onClick={this._handleClick.bind(this)} color=\"primary\" className={classes.button} aria-label=\"Add to shopping cart\" size=\"large\">\n            <CloudDownloadIcon onClick={(e)=>this._handleClick({target:{id:'download-form', value:e.target.value}})}/>\n          </IconButton>\n          </div>\n          <div className={classes.row}>\n            {grandTotal.toString() === 'NaN' &&\n              <div >\n                <Typography variant=\"subtitle1\" color=\"secondary\">Error: You picked an unavailable dimension.</Typography>\n              </div>}\n            {grandTotal === -1 &&\n              <div >\n                <Typography variant=\"subtitle1\" color=\"secondary\">Error: You have an incorrect fabric or incompatible selection.</Typography>\n              </div>}\n          </div>\n        </div>\n      )\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    form:state.form,\n    workbook:state.workbook\n  }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return bindActionCreators({\n    selectWorksheet,\n    setForm,\n    downloadFormRequested\n  }, dispatch);\n}\n\nexport default withStyles(styles)(connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(TextileForm))\n","import shortid from 'shortid';\n\nconst id = shortid.generate();\nconst initialState = {\n    projectId: id,\n    clientName: `client-${id}`,\n    selectedBlindType:'',\n    worksheets:[],\n    fabricToPriceGroupMapping: {\n      \"Cottonwood\":\"PG1\",\n      \"Linen\":\"PG1\",\n      \"Vinyl 4 Ply\":\"PG1\",\n      \"Bali\":\"PG2\",\n      \"Boardwalk\":\"PG2\",\n      \"CS 103\":\"PG2\",\n      \"CS 105\":\"PG2\",\n      \"Gabardine\":\"PG2\",\n      \"Merino\":\"PG2\",\n      \"Petals\":\"PG2\",\n      \"Satin Privacy\":\"PG2\",\n      \"Wool Privacy\":\"PG2\",\n      \"York_solid\":\"PG2\",\n      \"CS 101\":\"PG3\",\n      \"Denim Privacy\":\"PG3\",\n      \"DX 201\":\"PG3\",\n      \"EZ 900\":\"PG3\",\n      \"Glow\":\"PG3\",\n      \"Lattice Translucent\":\"PG3\",\n      \"Matisse\":\"PG3\",\n      \"Water Colour\":\"PG3\",\n      \"Berber\":\"PG4\",\n      \"Bling\":\"PG4\",\n      \"Earth 2\":\"PG4\",\n      \"Flicker Translucent\":\"PG4\",\n      \"Lavish\":\"PG4\",\n      \"Reed\":\"PG4\",\n      \"Vinyl Wideshade\":\"PG4\",\n      \"Lattice Opaque\":\"PG5\",\n      \"Mist\":\"PG5\",\n      \"Wool Opaque\":\"PG5\",\n      \"Apex View 4-5%\":\"PG6\",\n      \"Denim Opaque\":\"PG6\",\n      \"ELT 303\":\"PG6\",\n      \"EPT 301\":\"PG6\",\n      \"Rococo\":\"PG6\",\n      \"Satin Opaque\":\"PG6\",\n      \"Apex View 2-3%\":\"PG7\",\n      \"Apex Reflect 2-3%\":\"PG7\",\n      \"Basket Privacy\":\"PG7\",\n      \"Matrix 2%\":\"PG7\",\n      \"Z Splendor\":\"PG7\",\n      \"Summit Privacy\":\"PG7\",\n      \"Wave\":\"PG7\",\n      \"Flicker Opaque\":\"PG8\",\n      \"Summit Reflect\":\"PG8\",\n      \"Paper\":\"PG9\",\n      \"Trilogy\":\"PG9\",\n      \"Apex Opaque\":\"PG10\",\n      \"Basket Opaque\":\"PG10\",\n      \"Bubble\":\"PG10\",\n      \"CSR 103\":\"PG10\",\n    },\n    hembars:['Plain Hem', 'Slim Bar', 'Wrapped Accubar Hem Bar & Wrapped Hem Bar'],\n    motorizations:['Sun Glo','Somfy'],\n    priceGroups:[\"PG1\",\"PG2\",\"PG3\",\"PG4\",\"PG5\",\"PG6\",\"PG7\",\"PG8\",\"PG9\",\"PG10\"],\n    priceGroupMap:[\"A5:S24\", \"A30:S49\", \"A55:S74\", \"A80:S99\",\"A105:S124\", \"A130:S149\", \"A155:S174\",\"A180:S199\",\"A205:S224\",\"A230:S249\"],\n    priceGroupToValenceMapping: {\n      \"PG1\":[],\n      \"PG2\":[],\n      \"PG3\":[],\n      \"PG4\":[],\n      \"PG5\":[],\n      \"PG6\":[],\n      \"PG7\":[],\n      \"PG8\":[],\n      \"PG9\":[],\n      \"PG10\":[]\n    },\n    rooms:[{\n      id:shortid.generate(),\n      name:'Room 1',\n      description:'',\n      windows:[\n        {\n          id:shortid.generate(),\n          name: 'Window 1',\n          dimensions: {\n            units: 'inches',\n            height: 30,\n            width: 30\n          },\n          selectedValanceOption:'Decora 8',\n          selectedBlindType:'Roller',\n          selectedFabric:'Cottonwood',\n          selectedHem:'Plain Hem',\n          selectedMotorization:'Sun Glo',\n          selectedPriceGroup:'PG1',\n          showMotorization:false,\n          showValance:false,\n          total:155.95\n        }\n      ]\n    }],\n    selectedRoom: 0,\n    selectedWindow: 0,\n    selectedValance: 'R Valance',\n    valances:[\"R Valance\", \"V Valance\", \"I Valance\"],\n    valanceMap:[\"A1:S13\",\"A1:S7\",\"A1:S4\"],\n    valanceOptions: [],\n}\n\nconst form = (state = initialState, action) => {\n    console.log(action)\n    switch (action.type) {\n      case \"SET_FORM\":\n        return {\n          ...state,\n          ...action.payload\n        };\n      case 'WORKBOOK_IMPORT_SUCCESS':\n        return {\n            ...state,\n            selectedBlindType:action.payload.SheetNames[0],\n            worksheets:action.payload.SheetNames\n        }\n      case 'SELECT_WORKSHEET':\n        return {\n            ...state,\n            selectedBlindType:action.payload,\n            selectedValance: `${action.payload.charCodeAt(0).toUpperCase()} Valance`,\n            activeSheet:state.worksheets.find(ws=>ws)\n        }\n      default:\n        return state\n    }\n  }\n  export default form\n","const initialState = {\n    SheetNames:[],\n    Sheets:[],\n}\n\nconst workbook = (state = initialState, action) => {\n  console.log(action)\n  switch (action.type) {\n    case 'WORKBOOK_IMPORT_SUCCESS':\n      return {\n          ...state,\n          ...action.payload\n      }\n    case 'WORKBOOK_IMPORT_FAIL':\n      console.log(\"WORKBOOK_IMPORT_FAIL\")\n      console.log(action.payload)\n      return state;\n    default:\n      return state\n  }\n}\nexport default workbook\n","import { call, put, takeEvery } from 'redux-saga/effects';\nimport { Document, Paragraph, Packer } from 'docx';\n\nimport prettyjson from 'prettyjson';\nimport download from 'downloadjs';\n\nconst delay = (ms) => new Promise(res => setTimeout(res, ms));\n\nasync function createAndDownloadFile(parsedFormObj) {\n  try {\n\n    const fileText = prettyjson.render(parsedFormObj, {\n      keysColor: 'rainbow',\n      dashColor: 'magenta',\n      stringColor: 'white'\n    });\n\n    const doc = new Document();\n    const paragraph = new Paragraph(fileText);\n    doc.addParagraph(paragraph);\n\n    const packer = new Packer();\n    const b64string = await packer.toBase64String(doc)\n\n    return await download(fileText, `${parsedFormObj.clientName}.docx`, \"text/plain\");\n  } catch (e) {\n    console.log(e)\n    throw e\n  }\n}\n\nfunction* handleFormDownloadSaga(action) {\n  console.log(\"DO SOME ASYNC STUFF BRUGH!\")\n  try {\n    // let docx = officegen ( {\n    //   type: 'docx',\n    //   creator:'functional-aesthetics.design'\n    // } );\n    // let res = docx.generate(action.payload);\n    // console.log(res)\n\n    yield call(createAndDownloadFile, action.payload)\n    yield put({type:\"DOWNLOAD_FORM_SUCCESS\" })\n\n  } catch (e) {\n    yield put({type:\"DOWNLOAD_FORM_FAIL\", payload:e})\n    console.log(e);\n  }\n}\n\n// Our watcher Saga: spawn a new incrementAsync task on each INCREMENT_ASYNC\nexport function* downloadFormRequestedSaga() {\n  yield takeEvery('DOWNLOAD_FORM_REQUESTED', handleFormDownloadSaga)\n}\n","import { actionCreators,  } from 'redux'\nimport { compose, applyMiddleware, combineReducers, createStore } from 'redux'\nimport form from './form';\nimport workbook from './workbook';\n\nimport createSagaMiddleware from 'redux-saga'\n\nimport {downloadFormRequestedSaga} from './formSagas';\n\n\n// If Redux DevTools Extension is installed use it, otherwise use Redux compose\n/* eslint-disable no-underscore-dangle */\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n  ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})\n  : compose;\n/* eslint-enable no-underscore-dangle */\n\n// Apply Middleware & Compose Enhancers\nconst enhancers = [];\nconst middleware = [];\n\n\nconst rootReducer = combineReducers({\n    form,\n    workbook,\n});\n\n\nconst sagaMiddleware = createSagaMiddleware();\nmiddleware.push(sagaMiddleware);\nenhancers.push(applyMiddleware(...middleware));\n\nconst enhancer = composeEnhancers(...enhancers);\n\nexport default createStore(rootReducer, {}, enhancer);\n\nsagaMiddleware.run(downloadFormRequestedSaga);\n","import XLSX from 'xlsx';\n\nimport store from './store';\n\nexport default async function(fileUrl) {\n\n      var reader = new FileReader();\n      var fileBlob = await fetch(fileUrl);\n      fileBlob = await fileBlob.blob();\n\n      reader.onload = function(e) {\n        console.log(e)\n\n        var data = e.target.result;\n        var workbook = XLSX.read(data, {\n          type: 'binary'\n        });\n\n        // workbook.SheetNames.forEach(function(sheetName) {\n        //   // Here is your object\n        //   var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);\n        //   var json_object = JSON.stringify(XL_row_object);\n        // })\n        store.dispatch({type:'WORKBOOK_IMPORT_SUCCESS', payload:workbook});\n      };\n\n      reader.onerror = function(ex) {\n        store.dispatch({type:'WORKBOOK_IMPORT_FAIL', payload:ex});\n      };\n\n\n      reader.readAsBinaryString(fileBlob);\n\n  };\n","import React, { Component } from 'react';\nimport { Provider } from 'react-redux';\n\nimport {MuiThemeProvider} from '@material-ui/core/styles/'\nimport theme from './theme';\nimport TextileForm from './components/TextileForm';\n\nimport store from './store';\n\nimport ExcelToJSON from './ExcelToJSON';\n\n\n\nclass App extends Component {\n  componentWillMount(){\n     ExcelToJSON('./data/Price grids.xlsx');\n\n  }\n  render() {\n    return (\n      <Provider store={store}>\n        <MuiThemeProvider theme={theme}>\n          <TextileForm />\n        </MuiThemeProvider>\n      </Provider>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}