(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{122:function(e,t){},129:function(e,t,a){e.exports=a(339)},134:function(e,t,a){},299:function(e,t){},300:function(e,t){},339:function(e,t,a){"use strict";a.r(t);var o,n=a(1),r=a.n(n),l=a(21),i=a.n(l),s=(a(134),a(25)),c=a(26),d=a(29),m=a(27),h=a(28),u=a(70),p=a(18),w=Object(p.createMuiTheme)({palette:{type:"light"}}),g=a(90),b=a(22),f=a(32),v=a(30),O=a(124),P=a.n(O),y=a(125),E=a.n(y),G=a(20),k=a.n(G),C=a(19),W=a.n(C),R=a(7),x=a.n(R),F=a(35),S=a.n(F),j=a(67),_=a.n(j),N=a(68),T=a.n(N),V=a(45),I=a.n(V),A=a(46),D=a.n(A),M=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClick,o=e.handleChange,n=e.rooms,l=e.selectedRoom;return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:x()(t.row,t.descriptionField)},r.a.createElement(W.a,{className:t.typography,variant:"subtitle1"},"Rooms"),r.a.createElement("div",{style:{maxWidth:"12rem",textAlign:"center"}},r.a.createElement(W.a,{variant:"subtitle2"},"Add a room"),r.a.createElement(S.a,{className:t.fab,onClick:a,id:"add-room",size:"small",variant:"fab"},r.a.createElement(I.a,{onClick:function(e){return a({target:{id:"add-room"}})}})))),r.a.createElement(_.a,{value:l,onChange:function(e,t){return o({target:{id:"selectedRoom"}},t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",centered:!1},n.map(function(e){return r.a.createElement(T.a,{key:e.id,id:"selectedRoom",label:e.name})})),r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.row},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(k.a,{className:x()(t.textField,t.nameField),id:"room-name",label:"Name",value:n[l].name,onChange:o}),r.a.createElement(S.a,{className:t.fab,disabled:n.length<2,onClick:a,id:"remove-room",size:"small",variant:"fab"},r.a.createElement(D.a,{onClick:function(e){return a({target:{id:"remove-room"}})}})))),r.a.createElement(k.a,{id:"room-description",className:x()(t.textField,t.descriptionField),label:"Description",value:n[l].description,onChange:o})))}}]),t}(n.Component),L=Object(p.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0",maxWidth:"48rem"},container:{display:"flex",flexDirection:"column",margin:"0.5rem 0rem 0.5rem 0rem"},nameField:{maxWidth:"8rem"},descriptionField:{maxWidth:"32rem"},fab:{height:"2rem",width:"2rem",minWidth:"1rem"},textField:{margin:"0 0.5rem 0 0.5rem"},row:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}},{withTheme:!0})(M),B=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClick,o=e.handleChange,n=e.windows,l=e.selectedWindow;return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.row},r.a.createElement(W.a,{className:t.typography,variant:"subtitle1"},"Windows"),r.a.createElement("div",{style:{maxWidth:"12rem",textAlign:"center"}},r.a.createElement(W.a,{variant:"subtitle2"},"Add a window"),r.a.createElement(S.a,{className:t.fab,onClick:a,id:"add-window",size:"small",variant:"fab"},r.a.createElement(I.a,{onClick:function(e){return a({target:{id:"add-window"}})}})))),r.a.createElement(_.a,{value:l,onChange:function(e,t){return o({target:{id:"selectedWindow"}},t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},n.map(function(e){return r.a.createElement(T.a,{key:e.id,onClick:function(e){return console.log(e.target)},label:e.name})})),r.a.createElement("div",{className:t.container},r.a.createElement("div",{className:t.row},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(k.a,{className:x()(t.textField,t.nameField),id:"window-name",label:"Name",value:n[l].name,onChange:o}),r.a.createElement(S.a,{className:t.fab,onClick:a,disabled:n.length<2,id:"remove-window",size:"small",variant:"fab"},r.a.createElement(D.a,{onClick:function(e){return a({target:{id:"remove-window"}})}})))),r.a.createElement(k.a,{id:"window-description",className:x()(t.textField,t.descriptionField),label:"Description",value:n[l].description,onChange:o})))}}]),t}(n.Component),K=Object(p.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0",maxWidth:"32rem"},container:{display:"flex",flexDirection:"column",margin:"0.5rem 0rem 0.5rem 0rem"},nameField:{maxWidth:"8rem"},descriptionField:{maxWidth:"32rem"},fab:{height:"2rem",width:"2rem",minWidth:"1rem"},textField:{margin:"0 0.5rem 0 0.5rem"},row:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}})(B),U=a(65),q=a.n(U),H=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleChange,o=e.selectedItem,n=e.hidden,l=e.items,i=e.title,s=e.helperText;return r.a.createElement("div",{className:n?t.hidden:t.root},r.a.createElement(k.a,{id:i.toLowerCase(),select:!0,label:i,name:i.toLowerCase(),className:t.textField,value:o,onChange:function(e){return a({target:{id:i.toLowerCase(),value:e.target.value}})},SelectProps:{MenuProps:{className:t.menu}},helperText:s,margin:"normal",variant:"outlined"},l.map(function(e){return r.a.createElement(q.a,{key:e,value:e},e)})))}}]),t}(n.Component),z=Object(p.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0"},hidden:{display:"none"},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},dense:{marginTop:16},menu:{width:200}}})(H),X=Object(p.withStyles)({root:{},textField:{width:"5.5rem",margin:"0 0.5rem"}})(function(e){var t=e.classes,a=e.dimensions,o=e.handleChange,n=e.maxWidth,l=e.maxHeight;return console.log(n),console.log(l),r.a.createElement("div",{className:t.root},r.a.createElement(k.a,{id:"width",type:"number",className:t.textField,variant:"outlined",label:"Width",onChange:o,value:a.width,inputProps:{min:0,max:n}}),r.a.createElement(k.a,{id:"height",type:"number",className:t.textField,variant:"outlined",label:"Height",value:a.height,onChange:o,inputProps:{min:0,max:l}}))}),J=Object(p.withStyles)({root:{},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",alignItems:"center",margin:"1rem 0"},button:{margin:"0 1rem"}})(function(e){var t=e.classes,a=e.form,o=e.window,n=e.handleChange;return console.log("v form"),console.log(a.valanceOptions),console.log(o.selectedValanceOption),r.a.createElement("div",null,r.a.createElement("div",{className:t.row},r.a.createElement(W.a,{variant:"subtitle1"},"Valence Options"),r.a.createElement(S.a,{id:"toggle-valance",className:t.button,variant:"fab",onClick:n},o.showValance?r.a.createElement(D.a,null):r.a.createElement(I.a,null))),o.showValance&&r.a.createElement(z,{title:"Valance",id:"valance-option",helperText:"Please select valance option",items:a.valanceOptions,selectedItem:""!==o.selectedValanceOption?o.selectedValanceOption:a.valanceOptions[0],handleSelect:n}))}),Q=function(e){return{type:"DOWNLOAD_FORM_REQUESTED",payload:e}},Y=function(e){return{type:"SET_FORM",payload:e}},Z=function(e){return{type:"SELECT_WORKSHEET",payload:e}},$=a(52),ee=a.n($),te=function(e,t){var a=ee.a.utils.decode_range(e);console.log(a);var o,n,r,l=[];for(n=a.s.r;n<=a.e.r;n++){for(o=[],r=a.s.c;r<=a.e.c;r++){var i=t[ee.a.utils.encode_cell({r:n,c:r})];"undefined"===typeof i?o.push(void 0):o.push(i.v)}l.push(o)}return l},ae=a(36),oe=a.n(ae),ne=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this)))._handleChange=e._handleChange.bind(Object(f.a)(Object(f.a)(e))),e._calculateTotal=e._calculateTotal.bind(Object(f.a)(Object(f.a)(e))),e._calculateGrandTotal=e._calculateGrandTotal.bind(Object(f.a)(Object(f.a)(e))),e}return Object(h.a)(t,e),Object(c.a)(t,[{key:"_handleChange",value:function(e,t){console.log(e.target.id),console.log(e.target.value),console.log(t);var a=Object(b.a)({},this.props.form);switch(e.target.id){case"client-name":a.clientName=e.target.value,this.props.setForm(a);break;case"window-name":a.rooms[a.selectedRoom].windows[a.selectedWindow].name=e.target.value,this.props.setForm(a);break;case"window-description":a.rooms[a.selectedRoom].windows[a.selectedWindow].description=e.target.value,this.props.setForm(a);break;case"room-name":a.rooms[a.selectedRoom].name=e.target.value,this.props.setForm(a);break;case"room-description":a.rooms[a.selectedRoom].description=e.target.value,this.props.setForm(a);break;case"selectedRoom":a.selectedRoom=t,a.selectedWindow=0,this.props.setForm(a);break;case"selectedWindow":a.selectedWindow=t,this.props.setForm(a);break;case"worksheet":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedWorksheet=e.target.value,a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedValanceOption="".concat(e.target.value.charAt(0).toUpperCase()," Valance"),this.props.setForm(a);break;case"fabric":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedFabric=e.target.value,a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedPriceGroup=a.fabricToPriceGroupMapping[e.target.value],this.props.setForm(a);break;case"pricegroup":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedPriceGroup=e.target.value,this.props.setForm(a);break;case"toggle-valance":a.rooms[a.selectedRoom].windows[a.selectedWindow].showValance=!a.rooms[a.selectedRoom].windows[a.selectedWindow].showValance,this.props.setForm(a);break;case"valance":console.log("valence ch ange!"),console.log(a.rooms[a.selectedRoom].windows[a.selectedWindow]),console.log(e.target.value),a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedValanceOption=e.target.value,this.props.setForm(a);break;case"units":a.rooms[a.selectedRoom].windows[a.selectedWindow].dimensions[e.target.id]=e.target.value,this.props.setForm(a);break;case"width":case"height":a.rooms[a.selectedRoom].windows[a.selectedWindow].dimensions[e.target.id]=parseInt(e.target.value),this.props.setForm(a);break;default:console.log("unhandled "),console.log(e.target)}}},{key:"_handleClick",value:function(e,t){console.log(e.target.id);var a=Object(b.a)({},this.props.form);switch(e.target.id){case"download-form":this.props.downloadFormRequested(this._printForm(a));break;case"remove-room":a.rooms.splice(a.selectedRoom,1),a.selectedRoom=0,a.selectedWindow=0,this.props.setForm(a);break;case"remove-window":a.rooms[a.selectedRoom].windows.splice(a.selectedWindow,1),a.selectedWindow=0,this.props.setForm(a);break;case"add-room":a.rooms.push({id:oe.a.generate(),name:"Room ".concat(a.rooms.length+1),description:"",windows:[{id:oe.a.generate(),name:"Window ".concat(a.rooms[a.selectedRoom].windows.length),description:"",dimensions:{units:"inches",height:30,width:30},selectedValanceOption:"Decora 8",selectedWorksheet:"Roller",selectedFabric:"Cottonwood",selectedPriceGroup:"PG1",showValance:!1,total:155.95}]}),this.props.setForm(a);break;case"add-window":a.rooms[a.selectedRoom].windows.push({id:oe.a.generate(),name:"Window ".concat(a.rooms[a.selectedRoom].windows.length+1),description:"",dimensions:{units:"inches",width:30,height:30},selectedValanceOption:"Decora 8",selectedWorksheet:"Roller",selectedFabric:"Cottonwood",selectedPriceGroup:"PG1",showValance:!1,total:155.95}),this.props.setForm(a);break;default:console.log("unhandled "+e.target.id)}}},{key:"_calculateTotal",value:function(e,t,a){var o,n;console.log("calculatin "),console.log(e),console.log(t),console.log(a),"centimetres"===e.units?(o=parseFloat(.393701*e.width),n=parseFloat(.393701*e.width)):(o=parseFloat(e.width),n=parseFloat(e.height)),console.log("Calcuating for textile of width ".concat(o,"x").concat(n));var r=-1,l=-1,i=-1;if(t.length>0&&t[0].length>0){for(var s=t.length,c=(t[0].length,0);c<s;c++)0===c?l=t[c].slice(1).findIndex(function(e){return parseInt(e)>=o})+1:parseInt(t[c][0])>=n&&r<0&&(r=c);if(r<0)return console.log("No table match!"),-1;if(a.length>0){var d=a.length,m=(a[0].length,[]);console.log("making valance tables"),console.log(d),console.log(a);for(c=1;c<d;c++)m.push(a[c][0]),a[c][0]===this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption&&(i=c);return this.props.form.valanceOptions=m,i<0?-1:(parseFloat(t[r][l])+parseFloat(a[i][l])).toFixed(2)}return parseFloat(t[r][l]).toFixed(2)}return-1}},{key:"_calculateGrandTotal",value:function(){console.log("rooms"),console.log(this.props.form.rooms);var e,t=[];return t=this.props.form.rooms.length>1?this.props.form.rooms.reduce(function(e,t){return[].concat(Object(g.a)(e),Object(g.a)(t.windows))},[]):this.props.form.rooms[0].windows,console.log("the windows!"),console.log(t),console.log("GT:"),e=t.reduce(function(e,t){return e+t.total},0),console.log(e),e}},{key:"_printForm",value:function(e){var t=Object(b.a)({},e),a=[];return t.rooms.forEach(function(e,t){e.windows.forEach(function(t){t.showValance&&(t.ValanceOption=t.selectedValanceOption),t.Fabric=t.selectedFabric,t.PriceGroup=t.selectedPriceGroup,delete t.id,delete t.showValance,delete t.selectedValanceOption,delete t.selectedFabric,a.push(Object(b.a)({},t,{name:"".concat(e.name,"-").concat(t.name)}))})}),{projectId:e.projectId,clientName:e.clientName,windows:a,grandTotal:this._calculateGrandTotal()}}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,o=t.form,n=t.workbook,l=[],i=[];if(console.log("workbook:"),console.log(n),"undefined"!==typeof n.Sheets[o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedWorksheet]&&o.priceGroups.findIndex(function(e){return o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup})>-1){var s=o.priceGroups.findIndex(function(e){return e===o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup}),c=o.priceGroupMap[s];if(l=te(c,n.Sheets[o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedWorksheet]),o.rooms[o.selectedRoom].windows[o.selectedWindow].showValance){console.log("fetching valance table..."),console.log(o.selectedValance);var d=o.valances.findIndex(function(e){return e===o.selectedValance});console.log(d);var m=o.valanceMap[d];console.log(m),i=te(m,n.Sheets[o.selectedValance])}}var h=this._calculateTotal(o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions,l,i);o.rooms[o.selectedRoom].windows[o.selectedWindow].total=parseFloat(h);var u=this._calculateGrandTotal();return r.a.createElement("div",{className:a.root},r.a.createElement(W.a,{className:a.typography,variant:"title"},"Interactive Pricing Form"),r.a.createElement(W.a,{className:a.typography,variant:"subtitle1"},"Project Id.: ",o.projectId),r.a.createElement(k.a,{id:"project-name",label:"Client Name",value:o.clientName,onChange:this._handleChange.bind(this)}),r.a.createElement("div",{className:a.column},r.a.createElement(L,{handleClick:this._handleClick.bind(this),handleChange:this._handleChange.bind(this),rooms:o.rooms,selectedRoom:o.selectedRoom}),r.a.createElement(K,{handleClick:this._handleClick.bind(this),handleChange:this._handleChange.bind(this),windows:o.rooms[o.selectedRoom].windows,selectedWindow:o.selectedWindow})),r.a.createElement("div",{className:a.column},r.a.createElement(W.a,{className:a.typography,variant:"subtitle1"},"Dimensions and Type"),r.a.createElement(X,{maxWidth:l[0]?"inches"===o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units?l[0][l[0].length-1]:l[0][l[0].length-1]/.393701:0,maxHeight:l[0]?"inches"===o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units?l[l.length-1][0]:l[l.length-1][0]/.393701:0,dimensions:o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions,handleChange:this._handleChange.bind(this)}),r.a.createElement(z,{title:"Units",helperText:"Please select measurement unit",items:["inches","centimetres"],selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units,handleChange:this._handleChange.bind(this)})),r.a.createElement("div",{className:a.row},r.a.createElement(z,{title:"Worksheet",helperText:"Select a Worksheet",items:n.SheetNames.filter(function(e,t){return t%2===0}),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedWorksheet,handleChange:this._handleChange.bind(this)}),r.a.createElement(z,{title:"Fabric",helperText:"Select a Fabric",items:Object.keys(o.fabricToPriceGroupMapping),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedFabric,handleChange:this._handleChange.bind(this)}),r.a.createElement(z,{title:"PriceGroup",helperText:"Select a Price Group",hidden:!0,items:"Interlude"===o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedWorksheet?o.priceGroups.slice(0,4):o.priceGroups,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup,handleChange:this._handleChange.bind(this)})),r.a.createElement(J,{form:o,window:o.rooms[o.selectedRoom].windows[o.selectedWindow],handleChange:this._handleChange.bind(this)}),r.a.createElement("div",null,r.a.createElement(W.a,{variant:"display1"},r.a.createElement("b",null,"Current Window Total:")," ",h," ")),r.a.createElement("div",{className:a.row},r.a.createElement(W.a,{variant:"display2"},r.a.createElement("b",null,"Total:")," ",u.toFixed(2).toString()," "),r.a.createElement(P.a,{id:"download-form",onClick:this._handleClick.bind(this),color:"primary",className:a.button,"aria-label":"Add to shopping cart",size:"large"},r.a.createElement(E.a,{onClick:function(t){return e._handleClick({target:{id:"download-form",value:t.target.value}})}}))))}}]),t}(n.Component),re=Object(p.withStyles)(function(e){return{button:{margin:e.spacing.unit},root:{padding:"1rem"},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",margin:"1rem 0",alignItems:"center"},typography:{margin:"0.5rem 0 0.5rem 0"}}})(Object(u.b)(function(e,t){return{form:e.form,workbook:e.workbook}},function(e,t){return Object(v.b)({selectWorksheet:Z,setForm:Y,downloadFormRequested:Q},e)})(ne)),le=a(39),ie=oe.a.generate(),se=(o={projectId:ie,clientName:"client-".concat(ie),selectedWorksheet:"",worksheets:[],fabricToPriceGroupMapping:{Cottonwood:"PG1",Linen:"PG1","Vinyl 4 Ply":"PG1",Bali:"PG2",Boardwalk:"PG2","CS 103":"PG2","CS 105":"PG2",Gabardine:"PG2",Merino:"PG2",Petals:"PG2","Satin Privacy":"PG2","Wool Privacy":"PG2",York_solid:"PG2","CS 101":"PG3","Denim Privacy":"PG3","DX 201":"PG3","EZ 900":"PG3",Glow:"PG3","Lattice Translucent":"PG3",Matisse:"PG3","Water Colour":"PG3",Berber:"PG4",Bling:"PG4","Earth 2":"PG4","Flicker Translucent":"PG4",Lavish:"PG4",Reed:"PG4","Vinyl Wideshade":"PG4","Lattice Opaque":"PG5",Mist:"PG5","Wool Opaque":"PG5","Apex View 4-5%":"PG6","Denim Opaque":"PG6","ELT 303":"PG6","EPT 301":"PG6",Rococo:"PG6","Satin Opaque":"PG6","Apex View 2-3%":"PG7","Apex Reflect 2-3%":"PG7","Basket Privacy":"PG7","Matrix 2%":"PG7","Z Splendor":"PG7","Summit Privacy":"PG7",Wave:"PG7","Flicker Opaque":"PG8","Summit Reflect":"PG8",Paper:"PG9",Trilogy:"PG9","Apex Opaque":"PG10","Basket Opaque":"PG10",Bubble:"PG10","CSR 103":"PG10"},priceGroups:["PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10"],priceGroupMap:["A5:S24","A30:S49","A55:S74","A80:S99","A105:S124","A130:S149","A155:S174","A180:S199","A205:S224","A230:S249"],showValance:!1,selectedValance:"R Valance",priceGroupToValenceMapping:{PG1:[],PG2:[],PG3:[],PG4:[],PG5:[],PG6:[],PG7:[],PG8:[],PG9:[],PG10:[]},rooms:[{id:oe.a.generate(),name:"Room 1",description:"",windows:[{id:oe.a.generate(),name:"Window 1",dimensions:{units:"inches",height:30,width:30},selectedValanceOption:"Decora 8",selectedWorksheet:"Roller",selectedFabric:"Cottonwood",selectedPriceGroup:"PG1",showValance:!1,total:155.95}]}],selectedRoom:0,selectedWindow:0},Object(le.a)(o,"selectedValance","R Valance"),Object(le.a)(o,"valances",["R Valance","V Valance","I Valance"]),Object(le.a)(o,"valanceMap",["A1:S13","A1:S7","A1:S4"]),Object(le.a)(o,"valanceOptions",[]),o),ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"SET_FORM":return Object(b.a)({},e,t.payload);case"WORKBOOK_IMPORT_SUCCESS":return Object(b.a)({},e,{selectedWorksheet:t.payload.SheetNames[0],worksheets:t.payload.SheetNames});case"SELECT_WORKSHEET":return Object(b.a)({},e,{selectedWorksheet:t.payload,selectedValance:"".concat(t.payload.charCodeAt(0).toUpperCase()," Valance"),activeSheet:e.worksheets.find(function(e){return e})});default:return e}},de={SheetNames:[],Sheets:[]},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"WORKBOOK_IMPORT_SUCCESS":return Object(b.a)({},e,t.payload);case"WORKBOOK_IMPORT_FAIL":return console.log("WORKBOOK_IMPORT_FAIL"),console.log(t.payload),e;default:return e}},he=a(128),ue=a(23),pe=a.n(ue),we=a(69),ge=a(38),be=a(72),fe=a(126),ve=a.n(fe),Oe=a(127),Pe=a.n(Oe),ye=pe.a.mark(Ce),Ee=pe.a.mark(We);function Ge(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(we.a)(pe.a.mark(function e(t){var a,o,n,r;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=ve.a.render(t,{keysColor:"rainbow",dashColor:"magenta",stringColor:"white"}),o=new be.Document,n=new be.Paragraph(a),o.addParagraph(n),r=new be.Packer,e.next=8,r.toBase64String(o);case 8:return e.sent,e.next=11,Pe()(a,"".concat(t.clientName,".docx"),"text/plain");case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.t0;case 18:case"end":return e.stop()}},e,this,[[0,14]])}))).apply(this,arguments)}function Ce(e){return pe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("DO SOME ASYNC STUFF BRUGH!"),t.prev=1,t.next=4,Object(ge.a)(Ge,e.payload);case 4:return t.next=6,Object(ge.b)({type:"DOWNLOAD_FORM_SUCCESS"});case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(1),t.next=12,Object(ge.b)({type:"DOWNLOAD_FORM_FAIL",payload:t.t0});case 12:console.log(t.t0);case 13:case"end":return t.stop()}},ye,this,[[1,8]])}function We(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ge.c)("DOWNLOAD_FORM_REQUESTED",Ce);case 2:case"end":return e.stop()}},Ee,this)}var Re=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):v.d,xe=[],Fe=[],Se=Object(v.c)({form:ce,workbook:me}),je=Object(he.a)();Fe.push(je),xe.push(v.a.apply(void 0,Fe));var _e=Re.apply(void 0,xe),Ne=Object(v.e)(Se,{},_e);je.run(We);function Te(){return(Te=Object(we.a)(pe.a.mark(function e(t){var a,o;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FileReader,e.next=3,fetch(t);case 3:return o=e.sent,e.next=6,o.blob();case 6:o=e.sent,a.onload=function(e){console.log(e);var t=e.target.result,a=ee.a.read(t,{type:"binary"});Ne.dispatch({type:"WORKBOOK_IMPORT_SUCCESS",payload:a})},a.onerror=function(e){Ne.dispatch({type:"WORKBOOK_IMPORT_FAIL",payload:e})},a.readAsBinaryString(o);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Ve=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){!function(e){Te.apply(this,arguments)}("./data/Price grids.xlsx")}},{key:"render",value:function(){return r.a.createElement(u.a,{store:Ne},r.a.createElement(p.MuiThemeProvider,{theme:w},r.a.createElement(re,null)))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[129,2,1]]]);
//# sourceMappingURL=main.72bf125a.chunk.js.map