(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t){},131:function(e,t,a){e.exports=a(345)},136:function(e,t,a){},300:function(e,t){},301:function(e,t){},345:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),l=a(21),r=a.n(l),i=(a(136),a(25)),s=a(26),c=a(29),d=a(27),m=a(28),p=a(70),h=a(19),u=Object(h.createMuiTheme)({palette:{type:"light"}}),w=a(90),g=a(24),b=a(32),v=a(30),f=a(125),C=a.n(f),y=a(68),O=a.n(y),E=a(89),P=a.n(E),G=a(126),R=a.n(G),W=a(20),S=a.n(W),k=a(16),x=a.n(k),_=a(7),T=a.n(_),F=a(35),j=a.n(F),N=a(66),M=a.n(N),I=a(67),V=a.n(I),B=a(46),D=a.n(B),A=a(47),z=a.n(A),L=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClick,o=e.handleChange,l=e.rooms,r=e.selectedRoom;return n.a.createElement("div",{className:t.root},n.a.createElement("div",{className:T()(t.row,t.descriptionField)},n.a.createElement(x.a,{className:t.typography,variant:"subtitle1"},"Rooms"),n.a.createElement("div",{style:{maxWidth:"12rem",textAlign:"center"}},n.a.createElement(x.a,{variant:"subtitle2"},"Add a room"),n.a.createElement(j.a,{className:t.fab,onClick:a,id:"add-room",size:"small"},n.a.createElement(D.a,{onClick:function(e){return a({target:{id:"add-room"}})}})))),n.a.createElement(M.a,{value:r,onChange:function(e,t){return o({target:{id:"selectedRoom"}},t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",centered:!1},l.map(function(e){return n.a.createElement(V.a,{key:e.id,id:"selectedRoom",label:e.name})})),n.a.createElement("div",{className:t.container},n.a.createElement("div",{className:t.row},n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement(S.a,{className:T()(t.textField,t.nameField),id:"room-name",label:"Name",value:l[r].name,onChange:o}),n.a.createElement(j.a,{className:t.fab,disabled:l.length<2,onClick:a,id:"remove-room",size:"small"},n.a.createElement(z.a,{onClick:function(e){return a({target:{id:"remove-room"}})}})))),n.a.createElement(S.a,{id:"room-description",className:T()(t.textField,t.descriptionField),label:"Description",value:l[r].description,onChange:o})))}}]),t}(o.Component),H=Object(h.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0",maxWidth:"48rem"},container:{display:"flex",flexDirection:"column",margin:"0.5rem 0rem 0.5rem 0rem"},nameField:{maxWidth:"8rem"},descriptionField:{maxWidth:"32rem"},fab:{height:"2rem",width:"2rem",minWidth:"1rem"},textField:{margin:"0 0.5rem 0 0.5rem"},row:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}},{withTheme:!0})(L),K=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClick,o=e.handleChange,l=e.windows,r=e.selectedWindow;return n.a.createElement("div",{className:t.root},n.a.createElement("div",{className:t.row},n.a.createElement(x.a,{className:t.typography,variant:"subtitle1"},"Windows"),n.a.createElement("div",{style:{maxWidth:"12rem",textAlign:"center"}},n.a.createElement(x.a,{variant:"subtitle2"},"Add a window"),n.a.createElement(j.a,{className:t.fab,onClick:a,id:"add-window",size:"small"},n.a.createElement(D.a,{onClick:function(e){return a({target:{id:"add-window"}})}})))),n.a.createElement(M.a,{value:r,onChange:function(e,t){return o({target:{id:"selectedWindow"}},t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},l.map(function(e){return n.a.createElement(V.a,{key:e.id,onClick:function(e){return console.log(e.target)},label:e.name})})),n.a.createElement("div",{className:t.container},n.a.createElement("div",{className:t.row},n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement(S.a,{className:T()(t.textField,t.nameField),id:"window-name",label:"Name",value:l[r].name,onChange:o}),n.a.createElement(j.a,{className:t.fab,onClick:a,disabled:l.length<2,id:"remove-window",size:"small"},n.a.createElement(z.a,{onClick:function(e){return a({target:{id:"remove-window"}})}})))),n.a.createElement(S.a,{id:"window-description",className:T()(t.textField,t.descriptionField),label:"Description",value:l[r].description,onChange:o})))}}]),t}(o.Component),U=Object(h.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0",maxWidth:"32rem"},container:{display:"flex",flexDirection:"column",margin:"0.5rem 0rem 0.5rem 0rem"},nameField:{maxWidth:"8rem"},descriptionField:{maxWidth:"32rem"},fab:{height:"2rem",width:"2rem",minWidth:"1rem"},textField:{margin:"0 0.5rem 0 0.5rem"},row:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}})(K),q=a(64),X=a.n(q),Y=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"_camelToNormal",value:function(e){return e.replace(/([A-Z])/g," $1").replace(/^./,function(e){return e.toUpperCase()})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleChange,o=e.selectedItem,l=e.hidden,r=e.items,i=e.title,s=e.helperText;return n.a.createElement("div",{className:l?t.hidden:t.root},n.a.createElement(S.a,{id:i.toLowerCase(),select:!0,label:this._camelToNormal(i),name:i.toLowerCase(),className:t.textField,value:o,onChange:function(e){return a({target:{id:i.toLowerCase(),value:e.target.value}})},SelectProps:{id:i.toLowerCase(),MenuProps:{className:t.menu},autoWidth:!0},helperText:s,margin:"normal",variant:"outlined"},r.map(function(e){return n.a.createElement(X.a,{id:i.toLowerCase(),key:e,value:e},e)})))}}]),t}(o.Component),$=Object(h.withStyles)(function(e){return{root:{margin:"0.5rem 0 0.5rem 0",minWidth:"8rem",maxWidth:"12rem"},hidden:{display:"none"},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},dense:{marginTop:16},menu:{}}})(Y),Z=Object(h.withStyles)({root:{},textField:{width:"5.5rem",margin:"0 0.5rem"}})(function(e){var t=e.classes,a=e.dimensions,o=e.handleChange,l=e.maxWidth,r=e.maxHeight;return console.log(l),console.log(r),n.a.createElement("div",{className:t.root},n.a.createElement(S.a,{title:"width",id:"width",type:"number",className:t.textField,variant:"outlined",label:"Width",onChange:o,value:a.width,inputProps:{min:0,max:l}}),n.a.createElement(S.a,{title:"height",id:"height",type:"number",className:t.textField,variant:"outlined",label:"Height",value:a.height,onChange:o,inputProps:{min:0,max:r}}))}),J=Object(h.withStyles)({root:{},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",alignItems:"center",margin:"1rem 0"},button:{margin:"0 1rem"}})(function(e){var t=e.classes,a=e.disabled,o=e.form,l=e.window,r=e.handleChange;return console.log("v form"),console.log(o.valanceOptions),console.log(l.selectedValanceOption),console.log(a),n.a.createElement("div",null,n.a.createElement("div",{className:t.row},n.a.createElement(x.a,{variant:"subtitle1"},"Valence Options"),n.a.createElement(j.a,{id:"toggle-valance",disabled:a,className:t.button,onClick:r},l.showValance?n.a.createElement(z.a,{onClick:function(e){r({target:{id:"toggle-valance",value:e.target.value}})}}):n.a.createElement(D.a,{onClick:function(e){r({target:{id:"toggle-valance",value:e.target.value}})}}))),l.showValance&&n.a.createElement($,{title:"Valance",id:"valance-option",helperText:"Please select valance option",handleChange:r,items:o.valanceOptions,selectedItem:""!==l.selectedValanceOption?l.selectedValanceOption:o.valanceOptions[0],handleSelect:r}))}),Q=function(e){return{type:"DOWNLOAD_FORM_REQUESTED",payload:e}},ee=function(e){return{type:"SET_FORM",payload:e}},te=function(e){return{type:"SELECT_WORKSHEET",payload:e}},ae=a(53),oe=a.n(ae),ne=function(e,t){var a=oe.a.utils.decode_range(e);console.log(a);var o,n,l,r=[];for(n=a.s.r;n<=a.e.r;n++){for(o=[],l=a.s.c;l<=a.e.c;l++){var i=t[oe.a.utils.encode_cell({r:n,c:l})];"undefined"===typeof i?o.push(void 0):o.push(i.v)}r.push(o)}return r},le=a(36),re=a.n(le),ie=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this)))._handleChange=e._handleChange.bind(Object(b.a)(Object(b.a)(e))),e._calculateTotal=e._calculateTotal.bind(Object(b.a)(Object(b.a)(e))),e._calculateGrandTotal=e._calculateGrandTotal.bind(Object(b.a)(Object(b.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"_handleChange",value:function(e,t){console.log(e.target.id),console.log(e.target.value),console.log(t);var a=Object(g.a)({},this.props.form);switch(e.target.id){case"selectedpowercontrol":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedPowerControl=e.target.value;break;case"selectedremote":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedRemote=e.target.value;break;case"selectedendcap":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedEndCap=e.target.value;break;case"cordplacement":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedCordPlacement=e.target.value;break;case"show-motorization":a.rooms[a.selectedRoom].windows[a.selectedWindow].showMotorization=!a.rooms[a.selectedRoom].windows[a.selectedWindow].showMotorization,a.rooms[a.selectedRoom].windows[a.selectedWindow].showMotorization?a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedCordPlacement="None":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedCordPlacement="Left";break;case"selectedmotorization":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedMotorization=e.target.value;break;case"client-name":a.clientName=e.target.value;break;case"window-name":a.rooms[a.selectedRoom].windows[a.selectedWindow].name=e.target.value;break;case"window-description":a.rooms[a.selectedRoom].windows[a.selectedWindow].description=e.target.value;break;case"room-name":a.rooms[a.selectedRoom].name=e.target.value;break;case"room-description":a.rooms[a.selectedRoom].description=e.target.value;break;case"selectedRoom":a.selectedRoom=t,a.selectedWindow=0;break;case"selectedWindow":a.selectedWindow=t;break;case"selectedhem":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedHem=e.target.value;break;case"blindtype":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedBlindType=e.target.value;break;case"fabric":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedFabric=e.target.value,a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedPriceGroup=a.fabricToPriceGroupMapping[e.target.value];break;case"pricegroup":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedPriceGroup=e.target.value;break;case"toggle-valance":a.rooms[a.selectedRoom].windows[a.selectedWindow].showValance=!a.rooms[a.selectedRoom].windows[a.selectedWindow].showValance;break;case"valance":a.rooms[a.selectedRoom].windows[a.selectedWindow].selectedValanceOption=e.target.value;break;case"units":a.rooms[a.selectedRoom].windows[a.selectedWindow].dimensions[e.target.id]=e.target.value;break;case"width":case"height":a.rooms[a.selectedRoom].windows[a.selectedWindow].dimensions[e.target.id]=parseInt(e.target.value);break;default:console.log("unhandled "),console.log(e.target)}this.props.setForm(a)}},{key:"_handleClick",value:function(e,t){console.log(e.target.id);var a=Object(g.a)({},this.props.form);switch(e.target.id){case"download-form":this.props.downloadFormRequested(this._printForm(a));break;case"remove-room":a.rooms.splice(a.selectedRoom,1),a.selectedRoom=0,a.selectedWindow=0,this.props.setForm(a);break;case"remove-window":a.rooms[a.selectedRoom].windows.splice(a.selectedWindow,1),a.selectedWindow=0,this.props.setForm(a);break;case"add-room":a.rooms.push({id:re.a.generate(),name:"Room ".concat(a.rooms.length+1),description:"",windows:[{id:re.a.generate(),name:"Window ".concat(a.rooms[a.selectedRoom].windows.length),description:"",dimensions:{units:"inches",height:30,width:30},selectedValanceOption:"Decora 8",selectedBlindType:"Roller",selectedFabric:"Cottonwood",selectedPriceGroup:"PG1",showValance:!1,total:155.95}]}),this.props.setForm(a);break;case"add-window":a.rooms[a.selectedRoom].windows.push({id:re.a.generate(),name:"Window ".concat(a.rooms[a.selectedRoom].windows.length+1),description:"",dimensions:{units:"inches",width:30,height:30},selectedValanceOption:"Decora 8",selectedBlindType:"Roller",selectedFabric:"Cottonwood",selectedHem:"Plain Hem",selectedEndCap:"Gray",selectedMotorization:"Sun Glo",selectedPriceGroup:"PG1",showMotorization:!1,selectedCordPlacement:"Left",selectedPowerControl:"SG DC Charger",selectedRemote:"SG 1 Channel Standard",showValance:!1,total:155.95}),this.props.setForm(a);break;default:console.log("unhandled "+e.target.id)}}},{key:"_calculateTotal",value:function(e,t,a){var o,n,l=this;console.log("calculatin "),console.log(e),console.log(t),console.log(a),"centimetres"===e.units?(o=parseFloat(.393701*e.width),n=parseFloat(.393701*e.width)):(o=parseFloat(e.width),n=parseFloat(e.height)),console.log("Calcuating for textile of width ".concat(o,"x").concat(n));var r=-1,i=-1,s=-1,c=-1;if(t.length>0&&t[0].length>0){for(var d=t.length,m=(t[0].length,0);m<d;m++)0===m?i=t[m].slice(1).findIndex(function(e){return parseInt(e)>=o})+1:parseInt(t[m][0])>=n&&r<0&&(r=m);if(r<0)return console.log("No table match!"),-1;if(a.length>0){var p=a.length,h=(a[0].length,[]);console.log("making valance tables"),console.log(p),console.log(a);for(m=1;m<p;m++)h.push(a[m][0]),a[m][0]===this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption&&(s=m);if(this.props.form.valanceOptions=h,s<0)return-1;c=parseFloat(t[r][i])+parseFloat(a[s][i])}else c=parseFloat(t[r][i])}return c+=this.props.form.powerControlOptions.find(function(e){return e.type===l.props.form.rooms[l.props.form.selectedRoom].windows[l.props.form.selectedWindow].selectedPowerControl}).price,(c+=this.props.form.remoteOptions.find(function(e){return e.type===l.props.form.rooms[l.props.form.selectedRoom].windows[l.props.form.selectedWindow].selectedRemote}).price).toFixed(2)}},{key:"_calculateGrandTotal",value:function(){var e=[];return e=this.props.form.rooms.length>1?this.props.form.rooms.reduce(function(e,t){return[].concat(Object(w.a)(e),Object(w.a)(t.windows))},[]):this.props.form.rooms[0].windows,parseFloat(e.reduce(function(e,t){return e+t.total},0)).toFixed(2)}},{key:"_printForm",value:function(e){var t=Object(g.a)({},e),a=[];return t.rooms.forEach(function(e,t){e.windows.forEach(function(t){t.showValance&&(t.ValanceOption=t.selectedValanceOption),t.showMotorization&&(t.MotorizationOption=t.selectedMotorization),t.Fabric=t.selectedFabric,t.PriceGroup=t.selectedPriceGroup,delete t.id,delete t.showValance,delete t.showMotorization,delete t.selectedMotorization,delete t.selectedValanceOption,delete t.selectedFabric,a.push(Object(g.a)({},t,{name:"".concat(e.name,"-").concat(t.name)}))})}),{projectId:e.projectId,clientName:e.clientName,windows:a,grandTotal:this._calculateGrandTotal()}}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,o=t.form,l=t.workbook,r=[],i=[];if(console.log("workbook:"),console.log(l),"undefined"!==typeof l.Sheets[o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedBlindType]&&o.priceGroups.findIndex(function(e){return o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup})>-1){var s=o.priceGroups.findIndex(function(e){return e===o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup}),c=o.priceGroupMap[s];if(r=ne(c,l.Sheets[o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedBlindType]),o.rooms[o.selectedRoom].windows[o.selectedWindow].showValance){console.log("fetching valance table..."),console.log(o.selectedValance);var d=o.valances.findIndex(function(e){return e===o.selectedValance});console.log(d);var m=o.valanceMap[d];console.log(m),i=ne(m,l.Sheets[o.selectedValance])}}var p=this._calculateTotal(o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions,r,i);o.rooms[o.selectedRoom].windows[o.selectedWindow].total=parseFloat(p);var h=this._calculateGrandTotal();return n.a.createElement("div",{className:a.root},n.a.createElement(x.a,{className:a.typography,variant:"title"},"Interactive Pricing Form"),n.a.createElement(x.a,{className:a.typography,variant:"subtitle1"},"Project Id.: ",o.projectId),n.a.createElement(S.a,{id:"client-name",label:"Client Name",value:o.clientName,onChange:this._handleChange.bind(this)}),n.a.createElement("div",{className:a.column},n.a.createElement(H,{handleClick:this._handleClick.bind(this),handleChange:this._handleChange.bind(this),rooms:o.rooms,selectedRoom:o.selectedRoom}),n.a.createElement(U,{handleClick:this._handleClick.bind(this),handleChange:this._handleChange.bind(this),windows:o.rooms[o.selectedRoom].windows,selectedWindow:o.selectedWindow})),n.a.createElement("div",null,n.a.createElement(x.a,{variant:"display1"},"Window Properties")),n.a.createElement("div",{className:a.column},n.a.createElement(x.a,{className:a.typography,variant:"subtitle1"},"Dimensions and Units"),n.a.createElement(Z,{maxWidth:r[0]?"inches"===o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units?r[0][r[0].length-1]:r[0][r[0].length-1]/.393701:0,maxHeight:r[0]?"inches"===o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units?r[r.length-1][0]:r[r.length-1][0]/.393701:0,dimensions:o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions,handleChange:this._handleChange.bind(this)}),n.a.createElement($,{title:"Units",helperText:"Please select measurement unit",items:["inches","centimetres"],selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].dimensions.units,handleChange:this._handleChange.bind(this)})),n.a.createElement(x.a,{className:a.typography,variant:"subtitle1"},"Fabric"),n.a.createElement("div",{className:a.row},n.a.createElement($,{title:"BlindType",helperText:"Select a Blind Type",items:l.SheetNames.filter(function(e,t){return t%2===0}),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedBlindType,handleChange:this._handleChange.bind(this)}),n.a.createElement($,{title:"Fabric",helperText:"Select a Fabric",items:Object.keys(o.fabricToPriceGroupMapping),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedFabric,handleChange:this._handleChange.bind(this)}),n.a.createElement($,{title:"PriceGroup",helperText:"Select a Price Group",hidden:!0,items:"Interlude"===o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedBlindType?o.priceGroups.slice(0,4):o.priceGroups,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPriceGroup,handleChange:this._handleChange.bind(this)})),n.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1"},"Hem Options "),n.a.createElement($,{title:"SelectedHem",helperText:"Select a Hembar type",items:o.hembars,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedHem,handleChange:this._handleChange.bind(this)})),n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1"},"Hem Cap Options "),n.a.createElement($,{title:"SelectedEndCap",helperText:"Select a Hembar type",items:o.endCapOptions,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedEndCap,handleChange:this._handleChange.bind(this)}))),n.a.createElement("div",null,n.a.createElement(O.a,null,"Add Motorization"),n.a.createElement(C.a,{id:"show-motorization",checked:o.rooms[o.selectedRoom].windows[o.selectedWindow].showMotorization,onChange:this._handleChange.bind(this),value:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedMotorization}),o.rooms[o.selectedRoom].windows[o.selectedWindow].showMotorization&&n.a.createElement($,{title:"selectedMotorization",helperText:"Select a Motorization type",items:o.motorizations,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedMotorization,handleChange:this._handleChange.bind(this)}),!o.rooms[o.selectedRoom].windows[o.selectedWindow].showMotorization&&n.a.createElement("div",null,n.a.createElement(O.a,null,"Cord Placement"),n.a.createElement($,{title:"cordPlacement",helperText:"Select a Motorization type",items:o.cordPlacements,selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedCordPlacement,handleChange:this._handleChange.bind(this)}))),n.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1"},"Power Control Options "),n.a.createElement($,{title:"SelectedPowerControl",helperText:"Select a Power control type",items:o.powerControlOptions.map(function(e){return e.type}),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedPowerControl,handleChange:this._handleChange.bind(this)})),n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1"},"Remote Options "),n.a.createElement($,{title:"SelectedRemote",helperText:"Select a Remote type",items:o.remoteOptions.map(function(e){return e.type}),selectedItem:o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedRemote,handleChange:this._handleChange.bind(this)}))),n.a.createElement(J,{form:o,disabled:"Vision"===o.rooms[o.selectedRoom].windows[o.selectedWindow].selectedBlindType,window:o.rooms[o.selectedRoom].windows[o.selectedWindow],handleChange:this._handleChange.bind(this)}),n.a.createElement("div",null,n.a.createElement(x.a,{variant:"display1"},n.a.createElement("b",null,"Current Window Total:")," $",p," ")),n.a.createElement("div",{className:a.row},n.a.createElement(x.a,{variant:"display2"},n.a.createElement("b",null,"Total:")," ","$".concat(h)," "),n.a.createElement(P.a,{id:"download-form",disabled:-1===p,onClick:this._handleClick.bind(this),color:"primary",className:a.button,"aria-label":"Add to shopping cart",size:"large"},n.a.createElement(R.a,{onClick:function(t){return e._handleClick({target:{id:"download-form",value:t.target.value}})}}))),n.a.createElement("div",{className:a.row},"NaN"===h.toString()&&n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1",color:"secondary"},"Error: You picked an unavailable dimension.")),-1===h&&n.a.createElement("div",null,n.a.createElement(x.a,{variant:"subtitle1",color:"secondary"},"Error: You have an incorrect fabric or incompatible selection."))))}}]),t}(o.Component),se=Object(h.withStyles)(function(e){return{button:{margin:e.spacing.unit},root:{padding:"1rem"},column:{display:"flex",flexDirection:"column",margin:"1rem 0"},row:{display:"flex",flexDirection:"row",margin:"1rem 0"},typography:{margin:"0.5rem 0 0.5rem 0"}}})(Object(p.b)(function(e,t){return{form:e.form,workbook:e.workbook}},function(e,t){return Object(v.b)({selectWorksheet:te,setForm:ee,downloadFormRequested:Q},e)})(ie)),ce=re.a.generate(),de={projectId:ce,clientName:"client-".concat(ce),selectedBlindType:"",worksheets:[],cordPlacements:["Left","Right"],endCapOptions:["Gray","Blue","White"],powerControlOptions:[{type:"SG DC Charger",price:36},{type:"SG Solar Panel",price:84}],remoteOptions:[{type:"SG 1 Channel Standard",price:60},{type:"SG 15 Channel Standard",price:74},{type:"SG 1 Channel Touch",price:91},{type:"SG 15 Channel Touch",price:105},{type:"SG Connector Control Hub",price:393}],fabricToPriceGroupMapping:{Cottonwood:"PG1",Linen:"PG1","Vinyl 4 Ply":"PG1",Bali:"PG2",Boardwalk:"PG2","CS 103":"PG2","CS 105":"PG2",Gabardine:"PG2",Merino:"PG2",Petals:"PG2","Satin Privacy":"PG2","Wool Privacy":"PG2",York_solid:"PG2","CS 101":"PG3","Denim Privacy":"PG3","DX 201":"PG3","EZ 900":"PG3",Glow:"PG3","Lattice Translucent":"PG3",Matisse:"PG3","Water Colour":"PG3",Berber:"PG4",Bling:"PG4","Earth 2":"PG4","Flicker Translucent":"PG4",Lavish:"PG4",Reed:"PG4","Vinyl Wideshade":"PG4","Lattice Opaque":"PG5",Mist:"PG5","Wool Opaque":"PG5","Apex View 4-5%":"PG6","Denim Opaque":"PG6","ELT 303":"PG6","EPT 301":"PG6",Rococo:"PG6","Satin Opaque":"PG6","Apex View 2-3%":"PG7","Apex Reflect 2-3%":"PG7","Basket Privacy":"PG7","Matrix 2%":"PG7","Z Splendor":"PG7","Summit Privacy":"PG7",Wave:"PG7","Flicker Opaque":"PG8","Summit Reflect":"PG8",Paper:"PG9",Trilogy:"PG9","Apex Opaque":"PG10","Basket Opaque":"PG10",Bubble:"PG10","CSR 103":"PG10"},hembars:["Plain Hem","Slim Bar","Wrapped Accubar Hem Bar & Wrapped Hem Bar"],motorizations:["Sun Glo","Somfy"],priceGroups:["PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10"],priceGroupMap:["A5:S24","A30:S49","A55:S74","A80:S99","A105:S124","A130:S149","A155:S174","A180:S199","A205:S224","A230:S249"],priceGroupToValenceMapping:{PG1:[],PG2:[],PG3:[],PG4:[],PG5:[],PG6:[],PG7:[],PG8:[],PG9:[],PG10:[]},rooms:[{id:re.a.generate(),name:"Room 1",description:"",windows:[{id:re.a.generate(),name:"Window 1",dimensions:{units:"inches",height:30,width:30},selectedValanceOption:"Decora 8",selectedBlindType:"Roller",selectedFabric:"Cottonwood",selectedHem:"Plain Hem",selectedEndCap:"Gray",selectedMotorization:"Sun Glo",selectedPriceGroup:"PG1",showMotorization:!1,selectedCordPlacement:"Left",selectedPowerControl:"SG DC Charger",selectedRemote:"SG 1 Channel Standard",showValance:!1,total:155.95}]}],selectedRoom:0,selectedWindow:0,selectedValance:"R Valance",valances:["R Valance","V Valance","I Valance"],valanceMap:["A1:S13","A1:S7","A1:S4"],valanceOptions:[]},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"SET_FORM":return Object(g.a)({},e,t.payload);case"WORKBOOK_IMPORT_SUCCESS":return Object(g.a)({},e,{selectedBlindType:t.payload.SheetNames[0],worksheets:t.payload.SheetNames});case"SELECT_WORKSHEET":return Object(g.a)({},e,{selectedBlindType:t.payload,selectedValance:"".concat(t.payload.charCodeAt(0).toUpperCase()," Valance"),activeSheet:e.worksheets.find(function(e){return e})});default:return e}},pe={SheetNames:[],Sheets:[]},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"WORKBOOK_IMPORT_SUCCESS":return Object(g.a)({},e,t.payload);case"WORKBOOK_IMPORT_FAIL":return console.log("WORKBOOK_IMPORT_FAIL"),console.log(t.payload),e;default:return e}},ue=a(129),we=a(23),ge=a.n(we),be=a(69),ve=a(41),fe=a(72),Ce=a(127),ye=a.n(Ce),Oe=a(128),Ee=a.n(Oe),Pe=ge.a.mark(Se),Ge=ge.a.mark(ke);function Re(e){return We.apply(this,arguments)}function We(){return(We=Object(be.a)(ge.a.mark(function e(t){var a,o,n,l;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=ye.a.render(t,{keysColor:"rainbow",dashColor:"magenta",stringColor:"white"}),o=new fe.Document,n=new fe.Paragraph(a),o.addParagraph(n),l=new fe.Packer,e.next=8,l.toBase64String(o);case 8:return e.sent,e.next=11,Ee()(a,"".concat(t.clientName,".docx"),"text/plain");case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.t0;case 18:case"end":return e.stop()}},e,this,[[0,14]])}))).apply(this,arguments)}function Se(e){return ge.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("DO SOME ASYNC STUFF BRUGH!"),t.prev=1,t.next=4,Object(ve.a)(Re,e.payload);case 4:return t.next=6,Object(ve.b)({type:"DOWNLOAD_FORM_SUCCESS"});case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(1),t.next=12,Object(ve.b)({type:"DOWNLOAD_FORM_FAIL",payload:t.t0});case 12:console.log(t.t0);case 13:case"end":return t.stop()}},Pe,this,[[1,8]])}function ke(){return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ve.c)("DOWNLOAD_FORM_REQUESTED",Se);case 2:case"end":return e.stop()}},Ge,this)}var xe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):v.d,_e=[],Te=[],Fe=Object(v.c)({form:me,workbook:he}),je=Object(ue.a)();Te.push(je),_e.push(v.a.apply(void 0,Te));var Ne=xe.apply(void 0,_e),Me=Object(v.e)(Fe,{},Ne);je.run(ke);function Ie(){return(Ie=Object(be.a)(ge.a.mark(function e(t){var a,o;return ge.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FileReader,e.next=3,fetch(t);case 3:return o=e.sent,e.next=6,o.blob();case 6:o=e.sent,a.onload=function(e){console.log(e);var t=e.target.result,a=oe.a.read(t,{type:"binary"});Me.dispatch({type:"WORKBOOK_IMPORT_SUCCESS",payload:a})},a.onerror=function(e){Me.dispatch({type:"WORKBOOK_IMPORT_FAIL",payload:e})},a.readAsBinaryString(o);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Ve=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){!function(e){Ie.apply(this,arguments)}("./data/Price grids.xlsx")}},{key:"render",value:function(){return n.a.createElement(p.a,{store:Me},n.a.createElement(h.MuiThemeProvider,{theme:u},n.a.createElement(se,null)))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(Ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[131,2,1]]]);
//# sourceMappingURL=main.5e94cca3.chunk.js.map