{"version":3,"sources":["theme/index.js","components/RoomPanel.js","components/WindowPanel.js","components/OutlinedDropdown.js","components/WidthHeightTextInput.js","components/AddValanceOption.js","actions/form.js","methods/index.js","components/TextileForm.js","store/form.js","store/workbook.js","store/formSagas.js","store/index.js","ExcelToJSON.js","App.js","serviceWorker.js","index.js"],"names":["theme","createMuiTheme","palette","type","RoomPanel","_this$props","this","props","classes","handleClick","handleChange","rooms","selectedRoom","react_default","a","createElement","className","root","classNames","row","descriptionField","Typography_default","typography","variant","style","maxWidth","textAlign","Fab_default","fab","onClick","id","size","Add_default","e","target","Tabs_default","value","onChange","v","indicatorColor","textColor","scrollButtons","centered","map","r","Tab_default","key","label","name","container","display","alignItems","TextField_default","textField","nameField","disabled","length","Remove_default","description","Component","withStyles","margin","flexDirection","height","width","minWidth","justifyContent","withTheme","WindowPanel","windows","selectedWindow","console","log","OutlinedDropdown","str","replace","toUpperCase","selectedItem","hidden","items","title","helperText","concat","toLowerCase","select","_camelToNormal","SelectProps","MenuProps","menu","autoWidth","item","MenuItem_default","flexWrap","marginLeft","spacing","unit","marginRight","dense","marginTop","dimensions","maxHeight","paddingTop","inputProps","min","max","column","button","form","window","valanceOptions","selectedValanceOption","showValance","components_OutlinedDropdown","handleSelect","downloadFormRequested","payload","setForm","newForm","selectWorksheet","worksheet","parseTableFromRange","rangeString","sheet","range","XLSX","utils","decode_range","rowNum","colNum","activeTable","s","c","nextCell","encode_cell","push","TextileForm","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","_handleChange","bind","assertThisInitialized","_calculateTotal","_calculateGrandTotal","formCopy","objectSpread","selectedSomfyPowerOption","selectedSomfyControlSensorOption","extras","SomfyControlSensorOptions","find","cso","code","SomfyMotorOptions","mo","selectedSomfyMotorizationOption","SomfyPowerOptions","selectedHemColor","selectedSunGloPowerControl","selectedSunGloRemote","selectedSunGloConnectionHub","selectedMotorizationSeries","showMotorization","selectedCordPlacement","selectedEndCap","clientName","selectedHem","selectedBlindType","selectedFabric","selectedPriceGroup","fabricToPriceGroupMapping","parseInt","i","findIndex","ext","splice","_printForm","shortid","generate","units","selectedSomfyListControls","selectedSunGloMotorizationOption","total","dim","at","vt","textileWidthInInches","textileHeightInInches","_this2","parseFloat","findRow","findCol","findVRow","windowTotal","tableHeight","slice","tempOptions","connectionHubOptions","ch","price","powerControlOptions","pc","remoteOptions","ro","motorCode","po","forEach","extra","toFixed","reduce","w","r2","toConsumableArray","sum","copy","preppedWindows","ValanceOption","MotorizationOption","Fabric","PriceGroup","selectedMotorization","projectId","grandTotal","_this3","workbook","valanceTable","Sheets","priceGroups","pg","index","priceGroupMap","selectedValance","vindex","valances","valanceRangeString","valanceMap","currentWindow","components_RoomPanel","_handleClick","components_WindowPanel","WidthHeightTextInput","SheetNames","filter","keys","hembars","hemColorOptions","endCapOptions","AddValanceOption","InputLabel_default","Checkbox_default","checked","motorizationSeries","marginBetween","o","cordPlacements","Chip_default","onDelete","chip","color","IconButton_default","aria-label","CloudDownload_default","toString","padding","wide","connect","state","ownProps","dispatch","bindActionCreators","initialState","worksheets","SMB3","CL32","SMB4","SMB5","SMB1","A6U","A6","A10","Cottonwood","Linen","Vinyl 4 Ply","Bali","Boardwalk","CS 103","CS 105","Gabardine","Merino","Petals","Satin Privacy","Wool Privacy","York_solid","CS 101","Denim Privacy","DX 201","DX 203","EZ 900","Glow","Lattice Translucent","Matisse","Water Colour","Berber","Bling","Earth 2","Flicker Translucent","Lavish","Reed","Vinyl Wideshade","Lattice Opaque","Mist","Wool Opaque","Apex View 4-5%","Denim Opaque","ELT 303","EPT 301","Rococo","Satin Opaque","Apex View 2-3%","Apex Reflect 2-3%","Basket Privacy","Matrix 2%","Z Splendor","Summit Privacy","Wave","Flicker Opaque","Summit Reflect","Paper","Trilogy","Apex Opaque","Basket Opaque","Bubble","CSR 103","priceGroupToValenceMapping","PG1","PG2","PG3","PG4","PG5","PG6","PG7","PG8","PG9","PG10","arguments","undefined","action","charCodeAt","activeSheet","ws","handleFormDownloadSaga","downloadFormRequestedSaga","createAndDownloadFile","_callee","parsedFormObj","fileText","doc","paragraph","packer","regenerator_default","wrap","_context3","prev","next","prettyjson","render","keysColor","dashColor","stringColor","Document","Paragraph","addParagraph","Packer","toBase64String","sent","download","abrupt","t0","stop","_context","put","_marked","_context2","takeEvery","_marked2","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","enhancers","middleware","rootReducer","combineReducers","sagaMiddleware","createSagaMiddleware","applyMiddleware","apply","enhancer","createStore","run","fileUrl","reader","fileBlob","FileReader","fetch","blob","onload","data","result","read","store","onerror","ex","readAsBinaryString","App","_x","_ref","ExcelToJSON","es","styles","components_TextileForm","Boolean","location","hostname","match","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.90ee54bb.chunk.js","sourcesContent":["import {createMuiTheme} from '@material-ui/core/styles/';\n\nconst theme = createMuiTheme({\n  palette: {\n    type: 'light',\n  },\n});\n\nexport default theme;\n","import React, {Component} from 'react';\nimport classNames from 'classnames';\n\nimport Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    maxWidth:'80%'\n\n  },\n  container:{\n    display:'flex',\n    flexDirection:'column',\n    margin: '0.5rem 0rem 0.5rem 0rem'\n  },\n  nameField:{\n    maxWidth:'8rem'\n  },\n  descriptionField:{\n    maxWidth:'80%'\n  },\n  fab: {\n    //margin:theme.spacing.unit,\n    height:'2rem',\n    width:'2rem',\n    minWidth:'1rem'\n  },\n  textField:{\n    margin:'0 0.5rem 0 0.5rem'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    justifyContent:'space-between'\n  }\n})\n\n\n\nclass RoomPanel extends Component {\n\n  render(){\n    const {classes, handleClick, handleChange, rooms, selectedRoom} = this.props;\n    return (\n      <div className={classes.root} >\n        <div className={classNames(classes.row, classes.descriptionField)}>\n          <Typography className={classes.typography} variant=\"subtitle1\">Rooms</Typography>\n\n            <div style={{ maxWidth:'12rem', textAlign:'center'}}>\n              <Typography variant=\"subtitle2\">Add a room</Typography>\n              <Fab className={classes.fab} onClick={handleClick} id=\"add-room\" size=\"small\">\n                <AddIcon onClick={(e)=>handleClick({target:{id:'add-room'}})}></AddIcon>\n              </Fab>\n            </div>\n\n          </div>\n        {/*rooms.find(r=>r.name===selectedRoom).name*/}\n        <Tabs\n            value={selectedRoom}\n            onChange={(e,v)=>handleChange({target:{id:'selectedRoom'}},v)}\n\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            variant=\"scrollable\"\n            scrollButtons=\"auto\"\n            centered={false}\n          >\n            {rooms.map(r=>(\n              <Tab key={r.id} id=\"selectedRoom\" label={r.name} />))\n            }\n          </Tabs>\n           <div className={classes.container}>\n               <div className={classes.row}>\n                 <div style={{display:'flex', alignItems:'center'}}>\n                  <TextField\n                    className={classNames(classes.textField, classes.nameField)}\n                    id=\"room-name\"\n                    label=\"Name\"\n                    value={rooms[selectedRoom].name}\n                    onChange={handleChange}\n                    />\n                  <Fab className={classes.fab} disabled={rooms.length < 2} onClick={handleClick} id=\"remove-room\" size=\"small\">\n                    <RemoveIcon onClick={(e)=>handleClick({target:{id:'remove-room'}})}></RemoveIcon>\n                  </Fab>\n                  </div>\n              </div>\n              <TextField\n                id=\"room-description\"\n                className={classNames(classes.textField, classes.descriptionField)}\n                label=\"Description\"\n                value={rooms[selectedRoom].description}\n                onChange={handleChange}\n                />\n           </div>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles, {withTheme:true})(RoomPanel)\n","import React, {Component} from 'react';\nimport classNames from 'classnames';\n\nimport Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\n\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    maxWidth:'80%'\n\n  },\n  container:{\n    display:'flex',\n    flexDirection:'column',\n    margin: '0.5rem 0rem 0.5rem 0rem'\n  },\n  nameField:{\n    maxWidth:'8rem'\n  },\n  descriptionField:{\n    maxWidth:'80%'\n  },\n  fab: {\n    //margin:theme.spacing.unit,\n    height:'2rem',\n    width:'2rem',\n    minWidth:'1rem'\n  },\n  textField:{\n    margin:'0 0.5rem 0 0.5rem'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    justifyContent:'space-between'\n  }\n})\n\n\n\n\nclass WindowPanel extends Component {\n\n  render(){\n    const {classes, handleClick, handleChange, windows, selectedWindow} = this.props;\n    return (\n      <div className={classes.root} >\n        <div className={classNames(classes.row, classes.descriptionField)}>\n          <Typography className={classes.typography} variant=\"subtitle1\">Windows</Typography>\n\n            <div style={{maxWidth:'12rem', textAlign:'center'}}>\n              <Typography variant=\"subtitle2\">Add a window</Typography>\n              <Fab className={classes.fab} onClick={handleClick} id=\"add-window\" size=\"small\">\n                <AddIcon onClick={(e)=>handleClick({target:{id:'add-window'}})}></AddIcon>\n              </Fab>\n            </div>\n\n          </div>\n\n        {/*rooms.find(r=>r.name===selectedRoom).name*/}\n        <Tabs\n            value={selectedWindow}\n            onChange={(e,v)=>handleChange({target:{id:'selectedWindow'}},v)}\n\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            variant=\"scrollable\"\n            scrollButtons=\"auto\"\n\n          >\n            {windows.map(r=>(\n              <Tab key={r.id} onClick={e=>console.log(e.target)} label={r.name} />))\n            }\n          </Tabs>\n          <div className={classes.container}>\n              <div className={classes.row}>\n                 <div style={{display:'flex', alignItems:'center'}}>\n                   <TextField\n                     className={classNames(classes.textField, classes.nameField)}\n                     id=\"window-name\"\n                     label=\"Name\"\n                     value={windows[selectedWindow].name}\n                     onChange={handleChange}\n                     />\n\n                   <Fab className={classes.fab} onClick={handleClick} disabled={windows.length < 2} id=\"remove-window\" size=\"small\">\n                    <RemoveIcon onClick={(e)=>handleClick({target:{id:'remove-window'}})}></RemoveIcon>\n                   </Fab>\n                 </div>\n\n             </div>\n             <TextField\n               id=\"window-description\"\n               className={classNames(classes.textField, classes.descriptionField)}\n               label=\"Description\"\n               value={windows[selectedWindow].description}\n               onChange={handleChange}\n               />\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles)(WindowPanel)\n","import React, {Component} from 'react';\n\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport { withStyles } from '@material-ui/core/styles';\n\nconst styles = theme => ({\n  root:{\n    margin:'0.5rem 0 0.5rem 0',\n    minWidth:'12rem',\n  },\n  hidden:{\n    display:'none'\n  },\n  container: {\n   display: 'flex',\n   flexWrap: 'wrap',\n },\n textField: {\n   marginLeft: theme.spacing.unit,\n   marginRight: theme.spacing.unit,\n },\n dense: {\n   marginTop: 16,\n },\n menu: {\n   //width: 200,\n },\n})\n\n\n\nclass OutlinedDropdown extends Component {\n  _camelToNormal(str){\n    return str\n    // insert a space before all caps\n     .replace(/([A-Z])/g, ' $1')\n     // uppercase the first character\n     .replace(/^./, function(str){ return str.toUpperCase(); });\n  }\n  render(){\n    const {classes, handleChange, selectedItem, hidden, items, title, helperText} = this.props;\n    console.log(`${title} --> ${selectedItem}`)\n    console.log(items)\n    return (\n      <div className={ hidden ? classes.hidden : classes.root}>\n        <TextField\n         id={title.toLowerCase()}\n         select\n         label={this._camelToNormal(title)}\n         name={title.toLowerCase()}\n         className={classes.textField}\n         value={selectedItem}\n         onChange={ e=>handleChange({target:{id:title.toLowerCase(), value:e.target.value}}) }\n         SelectProps={{\n           id:title.toLowerCase(),\n           MenuProps: {\n             className: classes.menu,\n           },\n           autoWidth:true\n         }}\n         helperText={helperText}\n         margin=\"normal\"\n         variant=\"outlined\"\n       >\n         {items.map(item => (\n           <MenuItem id={title.toLowerCase()}\n             key={item} value={item}>\n             {item}\n           </MenuItem>\n         ))}\n       </TextField>\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styles)(OutlinedDropdown)\n","\nimport React, {Component} from 'react';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n\nconst styles = {\n    root:{\n\n    },\n    textField:{\n      width:'5.5rem',\n      margin:'0 0.5rem'\n    }\n}\n\nexport default withStyles(styles)((props) => {\n    const {classes, dimensions, handleChange, maxWidth, maxHeight} = props;\n    console.log(maxWidth)\n    console.log(maxHeight)\n    return (\n    <div className={classes.root} style={{paddingTop:'1.5rem'}}>\n        <TextField\n          title=\"width\"\n          id=\"width\"\n          type=\"number\"\n          className={classes.textField}\n          variant=\"outlined\"\n          label=\"Width\"\n          onChange={handleChange}\n          value={dimensions.width}\n          inputProps={{\n             min:0,\n             max:maxWidth\n           }}/>\n        <TextField\n          title=\"height\"\n          id=\"height\"\n          type=\"number\"\n          className={classes.textField}\n          variant=\"outlined\"\n          label=\"Height\"\n          value={dimensions.height}\n          onChange={handleChange}\n          inputProps={{\n             min:0,\n             max:maxHeight\n           }}\n        />\n    </div>\n    )\n})\n","import React, {Component} from 'react';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n//import Button from '@material-ui/core/Button';\nimport Fab from '@material-ui/core/Fab';\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport Icon from '@material-ui/core/Icon';\n\nimport OutlinedDropdown from './OutlinedDropdown'\n\nconst styles = {\n  root:{\n\n  },\n  column:{\n    display:'flex',\n    flexDirection:'column',\n    margin:'1rem 0'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    alignItems:'center',\n    margin:'1rem 0'\n  },\n  button:{\n    margin:'0 1rem'\n  }\n}\nexport default withStyles(styles)((props)=>{\n  const {classes, disabled, form, window, handleChange} = props\n  console.log(\"v form\")\n  console.log(form.valanceOptions)\n  console.log(window.selectedValanceOption)\n  console.log(disabled)\n  return (\n    <div>\n      <div className={classes.row}>\n        <Typography variant=\"subtitle1\">Valence Options</Typography>\n        <Fab id=\"toggle-valance\" disabled={disabled} className={classes.button} onClick={handleChange}>\n          {window.showValance ? <RemoveIcon\n              onClick={(e)=>{handleChange({target:{id:'toggle-valance', value:e.target.value}})}}\n            ></RemoveIcon>:\n            <AddIcon\n              onClick={(e)=>{handleChange({target:{id:'toggle-valance', value:e.target.value}})}}\n              ></AddIcon>}\n        </Fab>\n      </div>\n      {window.showValance &&\n        <OutlinedDropdown\n          title=\"Valance\"\n          id=\"valance-option\"\n          helperText=\"Please select valance option\"\n          handleChange={handleChange}\n          items={form.valanceOptions}\n          selectedItem={window.selectedValanceOption !== \"\" ? window.selectedValanceOption : form.valanceOptions[0]}\n          handleSelect={handleChange}\n          />\n      }\n    </div>\n\n  )\n})\n","export const SELECT_WORKSHEET = 'SELECT_WORKSHEET';\nexport const SET_FORM = 'SET_FORM';\nexport const DOWNLOAD_FORM_REQUESTED = 'DOWNLOAD_FORM_REQUESTED';\n\nexport const downloadFormRequested = (form) => {\n    return {\n        type: DOWNLOAD_FORM_REQUESTED,\n        payload: form\n    }\n}\n\nexport const setForm = (newForm) => {\n    return {\n        type: SET_FORM,\n        payload: newForm\n    }\n}\nexport const selectWorksheet = (worksheet) => {\n    return {\n        type: SELECT_WORKSHEET,\n        payload: worksheet\n    }\n}\n","import XLSX from 'xlsx';\n\nexport const parseTableFromRange = (rangeString, sheet) => {\n     const range = XLSX.utils.decode_range(rangeString);\n     console.log(range)\n     var activeTable = [];\n     var result = [];\n     var row;\n     var rowNum;\n     var colNum;\n     //var range = XLSX.utils.decode_range(sheet['!ref']);\n     for(rowNum = range.s.r; rowNum <= range.e.r; rowNum++){\n        row = [];\n         for(colNum=range.s.c; colNum<=range.e.c; colNum++){\n            var nextCell = sheet[\n               XLSX.utils.encode_cell({r: rowNum, c: colNum})\n            ];\n            if( typeof nextCell === 'undefined' ){\n               row.push(void 0);\n            } else row.push(nextCell.v);\n         }\n         activeTable.push(row);\n     }\n\n     return activeTable;\n}\n","import React, {Component} from 'react';\n\nimport { connect } from 'react-redux';\nimport {bindActionCreators} from 'redux';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Chip from '@material-ui/core/Chip';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport RoomPanel from './RoomPanel';\nimport WindowPanel from './WindowPanel';\nimport OutlinedDropdown from './OutlinedDropdown';\n\n\nimport WidthHeightTextInput from './WidthHeightTextInput';\nimport AddValanceOption from './AddValanceOption'\n\n\nimport {downloadFormRequested, selectWorksheet, setForm} from '../actions/form';\nimport {parseTableFromRange} from '../methods';\nimport shortid from 'shortid';\n\n\n\n//import officegen from 'officegen';\n\n\n//UNIT CONVERSION\nconst CM_TO_INCH=0.393701;\n\nconst styles = theme => ({\n  button: {\n    margin: theme.spacing.unit,\n  },\n  root:{\n    padding:'1rem'\n  },\n  column:{\n    display:'flex',\n    flexDirection:'column',\n    margin:'1rem 0'\n  },\n  row:{\n    display:'flex',\n    flexDirection:'row',\n    margin:'1rem 0',\n    //alignItems:'center'\n  },\n  typography:{\n    margin:'0.5rem 0 0.5rem 0'\n  },\n  wide:{\n    width:'16rem'\n  },\n  chip: {\n    margin: theme.spacing.unit,\n  },\n  marginBetween: {\n    margin: '0 0.5rem'\n  }\n})\n\nclass TextileForm extends Component {\n  constructor(){\n    super();\n    this._handleChange = this._handleChange.bind(this)\n    this._calculateTotal = this._calculateTotal.bind(this)\n    this._calculateGrandTotal = this._calculateGrandTotal.bind(this)\n\n  }\n  _handleChange(e, v) {\n    console.log(e.target.id)\n    console.log(e.target.value)\n    console.log(v)\n    let formCopy = {...this.props.form}\n    console.log('FORMCOPY')\n    console.log(formCopy)\n    //let thisWindow = formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow];\n    switch(e.target.id) {\n      case \"selectedsomfypoweroption\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSomfyPowerOption = e.target.value;\n        break;\n      case \"selectedsomfycontrolsensoroption\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSomfyControlSensorOption = e.target.value;\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].extras.push(formCopy.SomfyControlSensorOptions.find(cso=>cso.type === e.target.value))\n        break;\n      case \"selectedsomfymotorizationoption\":\n        let code = formCopy.SomfyMotorOptions.find(mo=>mo.type === e.target.value).code;\n        console.log(\"got product code: \" + code)\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSomfyMotorizationOption = e.target.value;\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSomfyPowerOption = formCopy.SomfyPowerOptions[code][0].type;\n        break;\n      case \"selectedhemcolor\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedHemColor = e.target.value;\n        break;\n      case \"selectedsunglopowercontrol\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSunGloPowerControl = e.target.value;\n        break;\n      case \"selectedsungloremote\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSunGloRemote = e.target.value;\n\n        break;\n      case \"selectedsungloconnectionhub\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedSunGloConnectionHub = e.target.value;\n        break;\n\n      case \"selectedmotorizationseries\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedMotorizationSeries = e.target.value;\n        break;\n      case \"show-motorization\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showMotorization = !formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showMotorization;\n        if(formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showMotorization) {\n          //no cordplacement when motorization is true\n          formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedCordPlacement = 'None';\n        } else {\n          formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedCordPlacement = 'Left';\n        }\n        break;\n      case \"selectedendcap\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedEndCap = e.target.value;\n        break;\n      case \"cordplacement\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedCordPlacement = e.target.value;\n        break;\n      case \"client-name\":\n        formCopy.clientName = e.target.value\n        break;\n      case \"window-name\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].name = e.target.value;\n        break;\n      case \"window-description\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].description = e.target.value;\n        break;\n      case \"room-name\":\n        formCopy.rooms[formCopy.selectedRoom].name = e.target.value;\n        break;\n      case \"room-description\":\n        formCopy.rooms[formCopy.selectedRoom].description = e.target.value;\n        break;\n      case \"selectedRoom\":\n        formCopy.selectedRoom = v;\n        formCopy.selectedWindow = 0; //must reset incase out of index of new windows array!\n        break;\n      case \"selectedWindow\":\n        formCopy.selectedWindow = v;\n        break;\n      case \"selectedhem\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedHem = e.target.value\n        break;\n      case \"blindtype\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedBlindType = e.target.value\n        break;\n      case \"fabric\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedFabric = e.target.value;\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedPriceGroup = formCopy.fabricToPriceGroupMapping[e.target.value];\n        break;\n      case \"pricegroup\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedPriceGroup = e.target.value;\n        break;\n      case \"toggle-valance\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showValance = !formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].showValance\n        break;\n      case \"valance\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].selectedValanceOption = e.target.value;\n        break;\n      case \"units\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].dimensions[e.target.id] = e.target.value;\n        break;\n      case \"width\":\n      case \"height\":\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].dimensions[e.target.id] = parseInt(e.target.value);\n        break;\n      default:\n        console.log(\"unhandled \")\n        console.log(e.target)\n    }\n    this.props.setForm(formCopy)\n\n  }\n  _handleClick(e, v){\n    console.log(e.target.id)\n    console.log(v)\n    let formCopy = {...this.props.form}\n\n    switch(e.target.id) {\n      case \"removeExtra\":\n        let i = formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].extras.findIndex(ext=>ext.type === v);\n\n        formCopy.rooms[formCopy.selectedRoom].windows[formCopy.selectedWindow].extras.splice(i,1);\n\n        this.props.setForm(formCopy)\n\n        break;\n      case \"download-form\":\n        this.props.downloadFormRequested(this._printForm(formCopy));\n        break;\n      case \"remove-room\":\n        formCopy.rooms.splice(formCopy.selectedRoom,1);\n        formCopy.selectedRoom = 0;\n        formCopy.selectedWindow = 0;\n        this.props.setForm(formCopy)\n\n        break;\n      case \"remove-window\":\n        formCopy.rooms[formCopy.selectedRoom].windows.splice(formCopy.selectedWindow,1);\n        formCopy.selectedWindow = 0;\n        this.props.setForm(formCopy)\n\n        break;\n      case \"add-room\":\n        formCopy.rooms.push({\n          id:shortid.generate(),\n          name:`Room ${formCopy.rooms.length+1}`,\n          description: ``,\n          windows:[{\n            id:shortid.generate(),\n            name:`Window ${formCopy.rooms[formCopy.selectedRoom].windows.length+1}`,\n            description: ``,\n            dimensions: {\n              units: 'inches',\n              width:30,\n              height:30\n            },\n            extras:[],\n            selectedValanceOption:'Decora 8',\n            selectedBlindType:'Roller',\n            selectedFabric: formCopy.rooms[formCopy.selectedRoom].windows[formCopy.rooms[formCopy.selectedRoom].windows.length-1].selectedFabric,\n            selectedHem:'Plain Hem',\n            selectedHemColor:'White',\n            selectedEndCap:'Grey',\n            selectedSomfyMotorizationOption: `Roller Shade, Interlude, Illusions - R28`,\n            selectedSomfyPowerOption: `12V Reloadable Lithium Battery Tube`,\n            selectedSomfyControlSensorOption: `Telis 1 Channel RTS Remote Pure`,\n            selectedSomfyListControls:[],\n            selectedMotorizationSeries:'Sun Glo',\n            selectedSunGloMotorizationOption: `Default`,\n            selectedSunGloConnectionHub:'None',\n            selectedPriceGroup:'PG1',\n            showMotorization:false,\n            selectedCordPlacement: 'Left',\n            selectedSunGloPowerControl:'SG DC Charger',\n            selectedSunGloRemote:'SG 1 Channel Standard',\n            showValance:false,\n            total:155.95\n          }]\n        })\n        this.props.setForm(formCopy)\n\n        break;\n      case \"add-window\":\n        formCopy.rooms[formCopy.selectedRoom].windows.push({\n          id:shortid.generate(),\n          name:`Window ${formCopy.rooms[formCopy.selectedRoom].windows.length+1}`,\n          description: ``,\n          dimensions: {\n            units: 'inches',\n            width:30,\n            height:30\n          },\n          extras:[],\n          selectedValanceOption:'Decora 8',\n          selectedBlindType:'Roller',\n          selectedFabric: formCopy.rooms[formCopy.selectedRoom].windows[formCopy.rooms[formCopy.selectedRoom].windows.length-1].selectedFabric,\n          selectedHem:'Plain Hem',\n          selectedHemColor:'White',\n          selectedEndCap:'Grey',\n          selectedSomfyMotorizationOption: `Roller Shade, Interlude, Illusions - R28`,\n          selectedSomfyPowerOption: `12V Reloadable Lithium Battery Tube`,\n          selectedSomfyControlSensorOption: `Telis 1 Channel RTS Remote Pure`,\n          selectedSomfyListControls:[],\n          selectedMotorizationSeries:'Sun Glo',\n          selectedSunGloMotorizationOption: `Default`,\n          selectedSunGloConnectionHub:'None',\n          selectedPriceGroup:'PG1',\n          showMotorization:false,\n          selectedCordPlacement: 'Left',\n          selectedSunGloPowerControl:'SG DC Charger',\n          selectedSunGloRemote:'SG 1 Channel Standard',\n          showValance:false,\n          total:155.95\n        })\n        this.props.setForm(formCopy)\n\n        break;\n      default:\n        console.log(\"unhandled \" + e.target.id)\n    }\n  }\n  _calculateTotal(dim, at, vt) {\n    //this is bound to the scope!\n    console.log(\"calculatin \")\n    console.log(dim)\n    console.log(at)\n    console.log(vt)\n\n    //UNIT CONVERSION\n    let textileWidthInInches;\n    let textileHeightInInches;\n    if(dim.units === 'centimetres') {\n      textileWidthInInches = parseFloat(CM_TO_INCH*dim.width)\n      textileHeightInInches = parseFloat(CM_TO_INCH*dim.width)\n    } else {\n      textileWidthInInches = parseFloat(dim.width)\n      textileHeightInInches = parseFloat(dim.height)\n    }\n    console.log(`Calcuating for textile of width ${textileWidthInInches}x${textileHeightInInches}`)\n\n    //LOOKUP TABLES\n    let findRow = -1;\n    let findCol = -1;\n    let findVRow = -1;\n    let findVCol = -1;\n\n    let windowTotal = -1;\n\n    //EXCEL TABLE LOOKUP METHOD\n    if(at.length > 0 && at[0].length > 0 ) {\n      const tableHeight = at.length;  //rows\n      const tableWidth = at[0].length; //\n\n      for(var i=0; i<tableHeight; i++){\n        //ignore 0,0\n        if(i===0) {\n          //scan header row on first iteration\n          findCol = at[i].slice(1).findIndex(c=>parseInt(c)>=textileWidthInInches)+1;\n        } else {\n          //scans first element of each row on subsequent\n          if( parseInt(at[i][0])>=textileHeightInInches && findRow < 0) {\n            //parseInt(at[i][0])\n            findRow=i\n          }\n        }\n      }\n\n      if(findRow < 0) {\n        console.log(\"No table match!\")\n        return -1\n      }\n\n      if(vt.length > 0) {\n        //we know it will be in the same ColNumber, we just need to match the row\n        const tableHeight = vt.length;  //rows\n        const tableWidth = vt[0].length; //\n        //console.log(\"Parsing header row of valance table\")\n        //console.log(vt)\n        let tempOptions = []\n\n        //TODO: dont do this!\n        //if(this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption === '') this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption = vt[1][0]\n        console.log(\"making valance tables\")\n        console.log(tableHeight)\n        console.log(vt)\n        for(var i =1; i< tableHeight; i++ ) {\n          //console.log()\n          //console.log(vt[i][0] + \" compared to \" + this.props.form.selectedValanceOption)\n          tempOptions.push(vt[i][0])\n          if(vt[i][0] === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedValanceOption){\n            //console.log(\"found col match: \" + i)\n            findVRow = i;\n          }\n        }\n        this.props.form.valanceOptions = tempOptions  //SETS THE NEWLY PARSED valanceOptions on the form\n        //may not find row match if new worksheet\n        if(findVRow < 0) return -1\n        //width is assumed, same findCol\n\n        windowTotal = (parseFloat(at[findRow][findCol])+parseFloat(vt[findVRow][findCol]))\n      } else {\n\n        windowTotal = (parseFloat(at[findRow][findCol]));\n      }\n    }\n\n    //ADDITIONAL MOTORIZATION OPTIONS\n    if(this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].showMotorization) {\n      if(this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedMotorizationSeries === 'Sun Glo') {\n        windowTotal += 360.00 //default sunglo rechargeable motor\n        windowTotal += this.props.form.connectionHubOptions.find(ch=>ch.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSunGloConnectionHub).price;\n        windowTotal += this.props.form.powerControlOptions.find(pc=>pc.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSunGloPowerControl).price;\n        windowTotal += this.props.form.remoteOptions.find(ro=>ro.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSunGloRemote).price;\n      }\n      if(this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedMotorizationSeries === 'Somfy') {\n        let motorCode = this.props.form.SomfyMotorOptions.find(mo=>mo.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSomfyMotorizationOption).code\n\n        windowTotal += this.props.form.SomfyMotorOptions.find(mo=>mo.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSomfyMotorizationOption).price;\n\n        windowTotal += this.props.form.SomfyPowerOptions[motorCode].find(po=>po.type === this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].selectedSomfyPowerOption).price;\n        /* Control Sensor Options & Extra Items -- Should adapt and abstract this! */\n        this.props.form.rooms[this.props.form.selectedRoom].windows[this.props.form.selectedWindow].extras.forEach(extra=>{\n          windowTotal += extra.price;\n        })\n\n      }\n    }\n\n\n\n    return windowTotal.toFixed(2);\n  }\n  _calculateGrandTotal(){\n\n    let windows = []\n    let grandTotal = -1.00;\n    if(this.props.form.rooms.length > 1) {\n      windows = this.props.form.rooms.reduce((w,r2)=>{\n        return [...w, ...r2.windows];\n      }, []);\n    } else {\n      windows = this.props.form.rooms[0].windows;\n      //grandTotal = windowTotal\n    }\n\n    grandTotal = parseFloat(windows.reduce((sum,w)=>sum+w.total, 0))\n\n    return grandTotal.toFixed(2);\n  }\n\n  _printForm(form) {\n    var text = ``;\n    var copy = {...form}\n    var preppedWindows = [];\n\n    copy.rooms.forEach((r,i)=>{\n      r.windows.forEach(w=> {\n\n        if(w.showValance) {\n          w.ValanceOption = w.selectedValanceOption;\n        }\n        if(w.showMotorization && w.selectedMotorizationSeries === 'Sun Glo') {\n          w.MotorizationOption = w.selectedMotorizationSeries;\n          delete w.selectedSomfyPowerOption;\n          delete w.selectedSomfyListControls;\n          delete w.selectedSomfyMotorizationOption;\n          delete w.selectedSomfyControlSensorOption;\n\n        } else if (w.showMotorization && w.selectedMotorizationSeries === 'Somfy') {\n          delete w.selectedSunGloRemote;\n          delete w.selectedSunGloPowerControl;\n          delete w.selectedSunGloConnectionHub;\n          delete w.selectedSunGloMotorizationOption;\n          w.extras = w.extras.map(e=> ({\n            ...e,\n            price:parseFloat(e.price).toFixed(2)\n\n          }))\n        }\n        w.Fabric = w.selectedFabric;\n        w.PriceGroup = w.selectedPriceGroup;\n\n        delete w.id;\n        delete w.showValance;\n        delete w.showMotorization;\n        delete w.selectedMotorization;\n        delete w.selectedValanceOption;\n        delete w.selectedFabric;\n        preppedWindows.push({\n          ...w,\n          name:`${r.name}-${w.name}`,\n        });\n      }) });\n\n    return {\n      projectId: form.projectId,\n      clientName: form.clientName,\n      windows:preppedWindows,\n      grandTotal: this._calculateGrandTotal(),\n    }\n  }\n\n  render () {\n    const {classes, form, workbook} = this.props\n    let activeTable = []\n    let valanceTable = []\n\n    if(typeof workbook.Sheets[form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType] !== 'undefined' && form.priceGroups.findIndex(pg=>form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedPriceGroup) > -1) {\n      const index = form.priceGroups.findIndex(pg=>pg===form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedPriceGroup);\n      const rangeString = form.priceGroupMap[index]\n\n      activeTable = parseTableFromRange(rangeString, workbook.Sheets[form.rooms[form.selectedRoom].windows[form.selectedWindow].selectedBlindType])\n\n      if(form.rooms[form.selectedRoom].windows[form.selectedWindow].showValance) {\n        console.log(\"fetching valance table...\")\n        console.log(form.selectedValance)\n        const vindex = form.valances.findIndex(v=>v===form.selectedValance)\n        console.log(vindex)\n        const valanceRangeString = form.valanceMap[vindex]\n        console.log(valanceRangeString)\n        valanceTable = parseTableFromRange(valanceRangeString, workbook.Sheets[form.selectedValance]);\n      }\n\n    }\n\n    //var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);\n    //   var json_object = JSON.stringify(XL_row_object);\n\n    const windowTotal = this._calculateTotal(form.rooms[form.selectedRoom].windows[form.selectedWindow].dimensions, activeTable, valanceTable);\n    form.rooms[form.selectedRoom].windows[form.selectedWindow].total = parseFloat(windowTotal);  //hardset formstate\n\n    const grandTotal = this._calculateGrandTotal();\n\n    let currentWindow = form.rooms[form.selectedRoom].windows[form.selectedWindow];\n\n    let motorCode = form.SomfyMotorOptions.find(mo=>mo.type === currentWindow.selectedSomfyMotorizationOption).code\n    console.log(\"MOTORCODE: \" + motorCode)\n    return (\n        <div className={classes.root}>\n          <Typography className={classes.typography} variant=\"title\">Interactive Pricing Form</Typography>\n          <Typography className={classes.typography} variant=\"subtitle1\">Project Id.: {form.projectId}</Typography>\n          <TextField id=\"client-name\" label=\"Client Name\" value={form.clientName} onChange={this._handleChange.bind(this)}/>\n\n          <div className={classes.column}>\n            <RoomPanel handleClick={this._handleClick.bind(this)} handleChange={this._handleChange.bind(this)} rooms={form.rooms} selectedRoom={form.selectedRoom}/>\n            <WindowPanel handleClick={this._handleClick.bind(this)} handleChange={this._handleChange.bind(this)} windows={form.rooms[form.selectedRoom].windows} selectedWindow={form.selectedWindow}/>\n\n          </div>\n          <div>\n            <Typography variant=\"display1\">Window Properties</Typography>\n          </div>\n          <div className={classes.column}>\n            <Typography className={classes.typography} variant=\"subtitle1\">Dimensions and Units</Typography>\n            <div className={classes.row} >\n              <WidthHeightTextInput\n                maxWidth={activeTable[0] ? ( currentWindow.dimensions.units==='inches' ? activeTable[0][activeTable[0].length-1] : activeTable[0][activeTable[0].length-1]/CM_TO_INCH) : 0}\n                maxHeight={activeTable[0] ? ( currentWindow.dimensions.units==='inches' ? activeTable[activeTable.length-1][0] : activeTable[activeTable.length-1][0]/CM_TO_INCH) : 0}\n                dimensions={currentWindow.dimensions}\n                handleChange={this._handleChange.bind(this)}\n                />\n              <OutlinedDropdown\n                title=\"Units\"\n                helperText=\"Please select measurement unit\"\n                items={[\"inches\", \"centimetres\"]}\n                selectedItem={currentWindow.dimensions.units}\n                handleChange={this._handleChange.bind(this)}/>\n            </div>\n          </div>\n\n          <Typography className={classes.typography} variant=\"subtitle1\">Fabric</Typography>\n\n          {/*Work Sheets Select*/\n            (<div className={classes.row}>\n                <OutlinedDropdown\n                  title=\"BlindType\"\n                  helperText=\"Select a Blind Type\"\n                  items={workbook.SheetNames.filter(((a,i)=>i%2===0))}\n                  selectedItem={currentWindow.selectedBlindType}\n                  handleChange={this._handleChange.bind(this)}/>\n                <OutlinedDropdown\n                  title=\"Fabric\"\n                  helperText=\"Select a Fabric\"\n                  items={/*this.props.form.selectedBlindType === 'Interlude' ? this.props.form.priceGroups.slice(0,4) : this.props.form.priceGroups*/\n                    Object.keys(form.fabricToPriceGroupMapping)\n                  }\n                  selectedItem={currentWindow.selectedFabric}\n                  handleChange={this._handleChange.bind(this)}/>\n                <OutlinedDropdown\n                  title=\"PriceGroup\"\n                  helperText=\"Select a Price Group\"\n                  hidden={true}\n                  items={currentWindow.selectedBlindType === 'Interlude' ? form.priceGroups.slice(0,4) : form.priceGroups}\n                  selectedItem={currentWindow.selectedPriceGroup}\n                  handleChange={this._handleChange.bind(this)}/>\n              </div>)\n          }\n          {/* HEM + END CAP OPTIONS */}\n          <div style={{display:'flex', flexDirection:'row'}}>\n            <div>\n              <Typography variant=\"subtitle1\">Hem Options </Typography>\n                <OutlinedDropdown\n                  title=\"SelectedHem\"\n                  helperText=\"Select a Hembar type\"\n                  items={form.hembars}\n                  selectedItem={currentWindow.selectedHem}\n                  handleChange={this._handleChange.bind(this)}/>\n            </div>\n            <div>\n              <Typography variant=\"subtitle1\">Hem Bar Colour </Typography>\n                <OutlinedDropdown\n                  title=\"SelectedHemColor\"\n                  helperText=\"Select a Hem Bar Colour\"\n                  items={form.hemColorOptions}\n                  selectedItem={currentWindow.selectedHemColor}\n                  handleChange={this._handleChange.bind(this)}/>\n            </div>\n            <div>\n              <Typography variant=\"subtitle1\">End Cap Colour </Typography>\n                <OutlinedDropdown\n                  title=\"SelectedEndCap\"\n                  helperText=\"Select an End Cap colour\"\n                  items={form.endCapOptions}\n                  selectedItem={currentWindow.selectedEndCap}\n                  handleChange={this._handleChange.bind(this)}/>\n            </div>\n        </div>\n        {/* Valance Panel */}\n\n        <AddValanceOption\n          form={form}\n          disabled={currentWindow.selectedBlindType === 'Vision' ? true : false}\n          window={currentWindow}\n          handleChange={this._handleChange.bind(this)}/>\n\n        {/* Motorization Panel*/}\n        <div>\n          <InputLabel>{currentWindow.showMotorization ? `Remove Motorization` : `Add Motorization`}</InputLabel>\n          <Checkbox\n            id=\"show-motorization\"\n            checked={currentWindow.showMotorization}\n            onChange={this._handleChange.bind(this)}\n            value={currentWindow.selectedMotorizationSeries}\n          />\n        </div>\n\n          <div className={classes.row} style={{alignItems:'baseline'}}>\n            {\n              currentWindow.showMotorization && (\n                <div>\n                  <div>\n                    <InputLabel>Motorization Option</InputLabel>\n                    <OutlinedDropdown\n                      title=\"selectedMotorizationSeries\"\n                      helperText=\"Select a Motorization Series\"\n                      items={form.motorizationSeries}\n                      selectedItem={currentWindow.selectedMotorizationSeries}\n                      handleChange={this._handleChange.bind(this)}/>\n                  </div>\n                  { currentWindow.selectedMotorizationSeries === 'Sun Glo' &&\n                    <div>\n                    <Typography variant=\"subtitle1\">Sun Glo Options </Typography>\n                    <div className={classes.row}>\n                      <div className={classes.marginBetween}>\n                        <Typography variant=\"subtitle1\">Power Control Options </Typography>\n                          <OutlinedDropdown\n                            title=\"SelectedSunGloPowerControl\"\n                            helperText=\"Select a Power control type\"\n                            items={form.powerControlOptions.map(o=>o.type)}\n                            selectedItem={currentWindow.selectedSunGloPowerControl}\n                            handleChange={this._handleChange.bind(this)}/>\n                      </div>\n                      <div className={classes.marginBetween}>\n                        <Typography variant=\"subtitle1\">Connection Hub Options </Typography>\n                          <OutlinedDropdown\n                            title=\"SelectedSunGloConnectionHub\"\n                            helperText=\"Select a Connection Hub\"\n                            items={form.connectionHubOptions.map(o=>o.type)}\n                            selectedItem={currentWindow.selectedSunGloConnectionHub}\n                            handleChange={this._handleChange.bind(this)}/>\n                      </div>\n                      <div className={classes.marginBetween}>\n                        <Typography variant=\"subtitle1\">Remote Options </Typography>\n                          <OutlinedDropdown\n                            title=\"SelectedSunGloRemote\"\n                            helperText=\"Select a Remote type\"\n                            items={form.remoteOptions.map(o=>o.type)}\n                            selectedItem={currentWindow.selectedSunGloRemote}\n                            handleChange={this._handleChange.bind(this)}/>\n                      </div>\n                    </div>\n                  </div>\n                  }\n\n                  { currentWindow.selectedMotorizationSeries === 'Somfy' &&\n                    <div>\n                      <Typography variant=\"subtitle1\">Somfy Options </Typography>\n                      <div className={classes.row}>\n                          <OutlinedDropdown\n                            title=\"SelectedSomfyMotorizationOption\"\n                            helperText=\"Select a Motor option\"\n                            handleChange={this._handleChange.bind(this)}\n                            selectedItem={currentWindow.selectedSomfyMotorizationOption}\n                            items={form.SomfyMotorOptions.map(o=>o.type)}\n                            />\n                          <OutlinedDropdown\n                            title=\"SelectedSomfyPowerOption\"\n                            helperText=\"Select a Power option\"\n                            handleChange={this._handleChange.bind(this)}\n                            selectedItem={currentWindow.selectedSomfyPowerOption}\n                            items={form.SomfyPowerOptions[motorCode].map(o=>o.type)}\n                            />\n                          <OutlinedDropdown\n                            title=\"SelectedSomfyControlSensorOption\"\n                            helperText=\"Add controls and sensors\"\n                            handleChange={this._handleChange.bind(this)}\n                            selectedItem={currentWindow.selectedSomfyControlSensorOption}\n                            items={form.SomfyControlSensorOptions.map(o=>o.type)}\n                            />\n                      </div>\n                    </div>\n                  }\n                </div>\n              )\n            }\n            {\n              !currentWindow.showMotorization && (\n                <div style={{paddingTop:'0.75rem'}}>\n                  <InputLabel>Cord Placement</InputLabel>\n                  <OutlinedDropdown\n                    title=\"cordPlacement\"\n                    helperText=\"Select a Cord Placement\"\n                    items={form.cordPlacements}\n                    selectedItem={currentWindow.selectedCordPlacement}\n                    handleChange={this._handleChange.bind(this)}/>\n                </div>)\n            }\n\n          </div>\n          {\n            currentWindow.extras.length > 0 &&\n\n            form.rooms[form.selectedRoom].windows[form.selectedWindow].extras.map(extra=>{\n              return (\n                <Chip\n                  id=\"removeExtra\"\n                  label={extra.type}\n                  onDelete={\n                    (e)=>this._handleClick({target:{id:'removeExtra'}}, extra.type)\n                  }\n                  className={classes.chip}\n                  color=\"primary\"\n                />\n              )\n            })\n          }\n\n\n          <div>\n            <Typography variant=\"display1\"><b>Current Window Total:</b> ${windowTotal} </Typography>\n          </div>\n          <div className={classes.row}>\n            <Typography variant=\"display2\"><b>Total:</b> {\n              `$${grandTotal}`\n          } </Typography>\n        <IconButton id=\"download-form\" disabled={windowTotal === -1} onClick={(e)=>{this._handleClick({target:{id:'download-form'}})}} color=\"primary\" className={classes.button} aria-label=\"Add to shopping cart\" size=\"large\">\n            <CloudDownloadIcon/>\n          </IconButton>\n          </div>\n          <div className={classes.row}>\n            {grandTotal.toString() === 'NaN' &&\n              <div >\n                <Typography variant=\"subtitle1\" color=\"secondary\">Error: You picked an unavailable dimension.</Typography>\n              </div>}\n            {grandTotal === -1 &&\n              <div >\n                <Typography variant=\"subtitle1\" color=\"secondary\">Error: You have an incorrect fabric or incompatible selection.</Typography>\n              </div>}\n          </div>\n        </div>\n      )\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    form:state.form,\n    workbook:state.workbook\n  }\n}\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n  return bindActionCreators({\n    selectWorksheet,\n    setForm,\n    downloadFormRequested\n  }, dispatch);\n}\n\nexport default withStyles(styles)(connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(TextileForm))\n"," import shortid from 'shortid';\n\nconst id = shortid.generate();\nconst initialState = {\n    projectId: id,\n    clientName: `client-${id}`,\n    selectedBlindType:'',\n    worksheets:[],\n    cordPlacements:['Left', 'Right'],\n    endCapOptions:['White', 'Linen', 'Grey', 'Brown', 'Black', 'Blue' ],\n    hemColorOptions:['White', 'Linen', 'Anodized', 'Dark Bronze', 'Black'],\n    motorizationSeries:['Sun Glo','Somfy'],\n    SomfyControlSensorOptions:[{type:`Telis 1 Channel RTS Remote Pure`, description:`Pure`, code:`T1P`, price:189.00},\n    {type:`Telis 1 Channel RTS Remote Silver`, description:`Silver`, code:`T1S`, price:252.00},\n    {type:`Telis 1 Channel RTS Remote Lounge`, description:`Lounge`, code:`T1L`, price:295.00},\n    {type:`Telis 4 Channel RTS Remote Pure`, description:`Pure`, code:`T5P`, price:245.00},\n    {type:`Telis 4 Channel RTS Remote Silver`, description:`Silver`, code:`T5S`, price:315.00},\n    {type:`Telis 4 Channel RTS Remote Lounge`, description:`Lounge`, code:`T5L`, price:358.00},\n    {type:`Telis 4 Modulis Channel RTS Remote w/ Scroll Wheel Pure`, description:`Pure`, code:`TM5P`, price:446.00},\n    {type:`Telis 4 Modulis Channel RTS Remote w/ Scroll Wheel Silver`, description:`Silver`, code:`TM5S`, price:513.00},\n    {type:`Telis 4 Modulis Channel RTS Remote w/ Scroll Wheel Lounge`, description:`Lounge`, code:`TM5L`, price:513.00},\n    {type:`Telis 16 Channel RTS Remote w/ Scroll Wheel Pure`, description:`Pure`, code:`T16P`, price:641.00},\n    {type:`Telis 16 Channel RTS Remote w/ Scroll Wheel Silver`, description:`Silver`, code:`T16S`, price:705.00},\n    {type:`Telis 1 Chronis RTS Pure`, description:`Pure`, code:`T1CP`, price:655.00},\n    {type:`Telis 1 Chronis RTS Silver`, description:`Silver`, code:`T1CS`, price:732.00},\n    {type:`Decoflex 1 Channel Wall Switch`, description:`1 Channel`, code:`D1W`, price:358.00},\n    {type:`Decoflex 5 Channel Wall Switch`, description:`5 Channel`, code:`D5W`, price:375.00},\n    {type:`Smoove 1 Wall Switch`, description:`White`, code:`S1W`, price:190.00},\n    {type:`Somfy myLink WiFi to RTS`, description:`White`, code:`SML`, price:621.00},\n    {type:`Z-Wave to RTS Interface`, description:`White`, code:`ZRI`, price:1002.00},\n    {type:`Universal RTS 16 Channel Interface`, description:`Beige`, code:`URI`, price:1187.00},\n    {type:`RTS Repeater`, description:`Beige`, code:`RTSR`, price:531.00},\n  ],\n    SomfyPowerOptions:{\n      SMB3:[{type:`12V Reloadable Lithium Battery Tube`, code:`WF8`, description:`Pre-loaded with 8 AA Batteries`, price:124.00}, {type:`12V DC 1.25A Transformer (Wall Type)`, code:`WFT`, description:`Wall Type`, price:350.00}, {type:`12V Solar Pack Kit`, code:`SPK`, description:`Includes solar panel, 10AA battery tube & batteries, connections harness wire, mounting brackets & glass mount adhesive.`, price:318.00}],\n      CL32:[{type:`12V Reloadable Lithium Battery Tube`, code:`WF8`, description:`Pre-loaded with 8 AA Batteries`, price:124.00},\n        {type:`12V DC 1.25A Transformer (Wall Type)`, code:`WFT`, description:`Wall Type`, price:350.00},\n        {type:`12V Solar Pack Kit`, code:`SPK`, description:`Includes solar panel, 10AA battery tube & batteries, connections harness wire, mounting brackets & glass mount adhesive.`, price:318.00}],\n      SMB4:[{\n        type: `Sonesse 30 Wirefree Plug-in Charger`,\n        code: `WF9`,\n        description: ``,\n        price: 53.80\n      }],\n      SMB5:[{type:`12V Reloadable Lithium Battery Tube`, code:`WF8`, description:`Pre-loaded with 8 AA Batteries`, price:124.00},\n        {type:`12V DC 1.25A Transformer (Wall Type)`, code:`WFT`, description:`Wall Type`, price:350.00},\n        {type:`12V Solar Pack Kit`, code:`SPK`, description:`Includes solar panel, 10AA battery tube & batteries, connections harness wire, mounting brackets & glass mount adhesive.`, price:318.00 }],\n      SMB1:[ { type: `24V DC 1.66A Transformer (Wall Type)`, code:`DCW`, description:`1 Motor`, price:138.00}, { type:`24V DC 2.5A Transformer (Table Type)`, code:`DCT`, description:`1 Motor`, price:352.00}, { type:`24V DC 5A (Table Type)`, code:`DC3`, description:`3 Motors`, price:871.00}, { type:`24V DC 10A (Table Type)`, code:`DC6`, description:`6 Motors`, price:1353.00}, { type:`24V DC 15A (Table Type)`, code:`DC9`, description:`9 Motors`, price:1767.00}, { type:`Power/Control Distribution Enclosure Kit 5 Motors`, code:`PCD5`, description:`5 Motors`, price:2027.00}, { type:`Power/Control Distribution Enclosure Kit 10 Motors`, code:`PCD10`, description:`10 Motors`, price:2920.00}, { type:`Power/Control Distribution Enclosure Kit 15 Motors`, code:`PCD15`, description:`15 Motors`, price:4079.00}, { type:`Power/Control Distribution Enclosure Kit 20 Motors`, code:`PCD20`, description:`20 Motors`, price:4695.00} ],\n        A6U: [{type:`3' Plug-In Cable`, code:`AC03`, description:null, price:67.00}, {type:`6' Plug-In Cable`, code:`AC06`, description:null, price:77.00},{type:`12' Plug-In Cable`, code:`AC12`, description:null, price:81.00},{type:`18' Plug-In Cable`, code:`AC18`, description:null, price:81.00},{type:`24' Plug-In Cable`, code:`AC24`, description:null, price:116.00}],\n        A6: [{type:`3' Plug-In Cable`, code:`AC03`, description:null, price:67.00},{type:`6' Plug-In Cable`, code:`AC06`, description:null, price:77.00},{type:`12' Plug-In Cable`, code:`AC12`, description:null, price:81.00},{type:`18' Plug-In Cable`, code:`AC18`, description:null, price:81.00},{type:`24' Plug-In Cable`, code:`AC24`, description:null, price:116.00}],\n        A10: [{type:`3' Plug-In Cable`, code:`AC03`, description:null, price:67.00},{type:`6' Plug-In Cable`, code:`AC06`, description:null, price:77.00},{type:`12' Plug-In Cable`, code:`AC12`, description:null, price:81.00},{type:`18' Plug-In Cable`, code:`AC18`, description:null, price:81.00},{type:`24' Plug-In Cable`, code:`AC24`, description:null, price:116.00}]\n    },\n    SomfyMotorOptions:[\n    {\n      type:`Roller Shade, Interlude, Illusions - R28`,\n      code: `SMB3`,\n      description:`R28 Motor 12V (48 dBA - 56 dBA).  12lbs.`,\n      price: 485.00\n    },\n    {\n      type:`Roman Shade - Cord Lift WireFree CL32 RTS`,\n      code: `CL32`,\n      description:`Cord Lift Motor 12 V (53 dBA).8lbs.`,\n      price: 619.00\n    },{\n      type:`Roller Shade, Interlude, Illusions - Sonesse 30 Wirefree`,\n      code: `SMB4`,\n      description:`Sonesse 30 Wirefree Motor 12V (44dBA).  17.7 lbs`,\n      price: 717.00\n    },\n    {\n      type:`Roller Shade, Interlude, Illusions - Somfy R30 (Junior)`,\n      code: `SMB5`,\n      description:`Somfy R30 (Junior) (56 dBA).  3.1lbs.`,\n      price: 369.00\n    },\n    {\n      type:`Roller Shade, Interlude, Illusions - Sonesse 30`,\n      code: `SMB1`,\n      description:`Sonesse 30 (Quiet Motor) for Roller Shade (<44dBA).  17.7 lbs`,\n      price: 854.00\n    },\n    {\n      type:`Roller Shade - Sonesse Ultra 50 RTS (Ultra Quiet)`,\n      code: `A6U`,\n      description:`Sonesse Ultra 50 RTS (<38dBA).  52 lbs`,\n      price: 1410.00\n    },\n    {\n      type:`Roller Shade - Sonesse 50 RTS (<45dBA)`,\n      code: `A6`,\n      description:`Sonesse 50 RTS (<45dBA).  52 lbs`,\n      price: 1234.00\n    },\n    {\n      type:`Roller Shade - Sonesse 50 RTS (<47dBA)`,\n      code: `A10`,\n      description:`Sonesse 50 RTS (<47dBA).  88 lbs`,\n      price: 1488.00\n    }],\n    powerControlOptions:[{type:'SG DC Charger', price:36.00},{type:'SG Solar Panel', price:84.00}],\n    remoteOptions:[{type:'SG 1 Channel Standard', price:60.00},{type:'SG 15 Channel Standard', price:74.00},{type:'SG 1 Channel Touch', price:91.00},{type:'SG 15 Channel Touch', price:105.00}],\n    connectionHubOptions:[{type:'None', price:0.00}, {type:'SG Connector Control Hub', price:393.00}],\n    fabricToPriceGroupMapping: {\n      \"Cottonwood\":\"PG1\",\n      \"Linen\":\"PG1\",\n      \"Vinyl 4 Ply\":\"PG1\",\n      \"Bali\":\"PG2\",\n      \"Boardwalk\":\"PG2\",\n      \"CS 103\":\"PG2\",\n      \"CS 105\":\"PG2\",\n      \"Gabardine\":\"PG2\",\n      \"Merino\":\"PG2\",\n      \"Petals\":\"PG2\",\n      \"Satin Privacy\":\"PG2\",\n      \"Wool Privacy\":\"PG2\",\n      \"York_solid\":\"PG2\",\n      \"CS 101\":\"PG3\",\n      \"Denim Privacy\":\"PG3\",\n      \"DX 201\":\"PG3\",\n      \"DX 203\":\"PG3\",\n      \"EZ 900\":\"PG3\",\n      \"Glow\":\"PG3\",\n      \"Lattice Translucent\":\"PG3\",\n      \"Matisse\":\"PG3\",\n      \"Water Colour\":\"PG3\",\n      \"Berber\":\"PG4\",\n      \"Bling\":\"PG4\",\n      \"Earth 2\":\"PG4\",\n      \"Flicker Translucent\":\"PG4\",\n      \"Lavish\":\"PG4\",\n      \"Reed\":\"PG4\",\n      \"Vinyl Wideshade\":\"PG4\",\n      \"Lattice Opaque\":\"PG5\",\n      \"Mist\":\"PG5\",\n      \"Wool Opaque\":\"PG5\",\n      \"Apex View 4-5%\":\"PG6\",\n      \"Denim Opaque\":\"PG6\",\n      \"ELT 303\":\"PG6\",\n      \"EPT 301\":\"PG6\",\n      \"Rococo\":\"PG6\",\n      \"Satin Opaque\":\"PG6\",\n      \"Apex View 2-3%\":\"PG7\",\n      \"Apex Reflect 2-3%\":\"PG7\",\n      \"Basket Privacy\":\"PG7\",\n      \"Matrix 2%\":\"PG7\",\n      \"Z Splendor\":\"PG7\",\n      \"Summit Privacy\":\"PG7\",\n      \"Wave\":\"PG7\",\n      \"Flicker Opaque\":\"PG8\",\n      \"Summit Reflect\":\"PG8\",\n      \"Paper\":\"PG9\",\n      \"Trilogy\":\"PG9\",\n      \"Apex Opaque\":\"PG10\",\n      \"Basket Opaque\":\"PG10\",\n      \"Bubble\":\"PG10\",\n      \"CSR 103\":\"PG10\",\n    },\n    hembars:['Plain Hem', 'Slim Bar', 'Wrapped Accubar Hem Bar & Wrapped Hem Bar'],\n    priceGroups:[\"PG1\",\"PG2\",\"PG3\",\"PG4\",\"PG5\",\"PG6\",\"PG7\",\"PG8\",\"PG9\",\"PG10\"],\n    priceGroupMap:[\"A5:S24\", \"A30:S49\", \"A55:S74\", \"A80:S99\",\"A105:S124\", \"A130:S149\", \"A155:S174\",\"A180:S199\",\"A205:S224\",\"A230:S249\"],\n    priceGroupToValenceMapping: {\n      \"PG1\":[],\n      \"PG2\":[],\n      \"PG3\":[],\n      \"PG4\":[],\n      \"PG5\":[],\n      \"PG6\":[],\n      \"PG7\":[],\n      \"PG8\":[],\n      \"PG9\":[],\n      \"PG10\":[]\n    },\n    rooms:[{\n      id:shortid.generate(),\n      name:'Room 1',\n      description:'',\n      windows:[\n        {\n          id:shortid.generate(),\n          name: 'Window 1',\n          dimensions: {\n            units: 'inches',\n            height: 30,\n            width: 30\n          },\n          extras:[],\n          selectedValanceOption:'Decora 8',\n          selectedBlindType:'Roller',\n          selectedFabric:'Cottonwood',\n          selectedHem:'Plain Hem',\n          selectedHemColor:'White',\n          selectedEndCap:'Grey',\n          selectedSomfyMotorizationOption: `Roller Shade, Interlude, Illusions - R28`,\n          selectedSomfyPowerOption: `12V Reloadable Lithium Battery Tube`,\n          selectedSomfyControlSensorOption: `Telis 1 Channel RTS Remote Pure`,\n          selectedSomfyListControls:[],\n          selectedMotorizationSeries:'Sun Glo',\n          selectedSunGloMotorizationOption: `Default`,\n          selectedSunGloConnectionHub:'None',\n          selectedPriceGroup:'PG1',\n          showMotorization:false,\n          selectedCordPlacement: 'Left',\n          selectedSunGloPowerControl:'SG DC Charger',\n          selectedSunGloRemote:'SG 1 Channel Standard',\n          showValance:false,\n          total:155.95\n        }\n      ]\n    }],\n    selectedRoom: 0,\n    selectedWindow: 0,\n    selectedValance: 'R Valance',\n    valances:[\"R Valance\", \"V Valance\", \"I Valance\"],\n    valanceMap:[\"A1:S13\",\"A1:S7\",\"A1:S4\"],\n    valanceOptions: [],\n}\n\nconst form = (state = initialState, action) => {\n    console.log(action)\n    switch (action.type) {\n      case \"SET_FORM\":\n        return {\n          ...state,\n          ...action.payload\n        };\n      case 'WORKBOOK_IMPORT_SUCCESS':\n        return {\n            ...state,\n            selectedBlindType:action.payload.SheetNames[0],\n            worksheets:action.payload.SheetNames\n        }\n      case 'SELECT_WORKSHEET':\n        return {\n            ...state,\n            selectedBlindType:action.payload,\n            selectedValance: `${action.payload.charCodeAt(0).toUpperCase()} Valance`,\n            activeSheet:state.worksheets.find(ws=>ws)\n        }\n      default:\n        return state\n    }\n  }\n  export default form\n","const initialState = {\n    SheetNames:[],\n    Sheets:[],\n}\n\nconst workbook = (state = initialState, action) => {\n  console.log(action)\n  switch (action.type) {\n    case 'WORKBOOK_IMPORT_SUCCESS':\n      return {\n          ...state,\n          ...action.payload\n      }\n    case 'WORKBOOK_IMPORT_FAIL':\n      console.log(\"WORKBOOK_IMPORT_FAIL\")\n      console.log(action.payload)\n      return state;\n    default:\n      return state\n  }\n}\nexport default workbook\n","import { call, put, takeEvery } from 'redux-saga/effects';\nimport { Document, Paragraph, Packer } from 'docx';\n\nimport prettyjson from 'prettyjson';\nimport download from 'downloadjs';\n\n\n\nconst delay = (ms) => new Promise(res => setTimeout(res, ms));\n\nasync function createAndDownloadFile(parsedFormObj) {\n  try {\n\n    const fileText = prettyjson.render(parsedFormObj, {\n      keysColor: 'rainbow',\n      dashColor: 'magenta',\n      stringColor: 'white'\n    });\n    const doc = new Document();\n    const paragraph = new Paragraph(fileText);\n    doc.addParagraph(paragraph);\n\n    const packer = new Packer();\n    const b64string = await packer.toBase64String(doc)\n    return await download(fileText, `${parsedFormObj.clientName}.docx`, \"text/plain\");\n    // const docDefinition = {\n    //   content: [\n    //     {\n    //     \ttext: fileText,\n    //     \tpageBreak: 'after'\n    //     }\n    //   ]\n    // }\n    //\n    //\n    // return await window.pdfMake.createPdf(docDefinition).download();\n  } catch (e) {\n    console.log(e)\n    throw e\n  }\n}\n\nfunction* handleFormDownloadSaga(action) {\n  console.log(\"DO SOME ASYNC STUFF BRUGH!\")\n  try {\n    // let docx = officegen ( {\n    //   type: 'docx',\n    //   creator:'functional-aesthetics.design'\n    // } );\n    // let res = docx.generate(action.payload);\n    // console.log(res)\n\n    yield call(createAndDownloadFile, action.payload)\n    yield put({type:\"DOWNLOAD_FORM_SUCCESS\" })\n\n  } catch (e) {\n    yield put({type:\"DOWNLOAD_FORM_FAIL\", payload:e})\n    console.log(e);\n  }\n}\n\n// Our watcher Saga: spawn a new incrementAsync task on each INCREMENT_ASYNC\nexport function* downloadFormRequestedSaga() {\n  yield takeEvery('DOWNLOAD_FORM_REQUESTED', handleFormDownloadSaga)\n}\n","import { actionCreators,  } from 'redux'\nimport { compose, applyMiddleware, combineReducers, createStore } from 'redux'\nimport form from './form';\nimport workbook from './workbook';\n\nimport createSagaMiddleware from 'redux-saga'\n\nimport {downloadFormRequestedSaga} from './formSagas';\n\n\n// If Redux DevTools Extension is installed use it, otherwise use Redux compose\n/* eslint-disable no-underscore-dangle */\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n  ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({})\n  : compose;\n/* eslint-enable no-underscore-dangle */\n\n// Apply Middleware & Compose Enhancers\nconst enhancers = [];\nconst middleware = [];\n\n\nconst rootReducer = combineReducers({\n    form,\n    workbook,\n});\n\n\nconst sagaMiddleware = createSagaMiddleware();\nmiddleware.push(sagaMiddleware);\nenhancers.push(applyMiddleware(...middleware));\n\nconst enhancer = composeEnhancers(...enhancers);\n\nexport default createStore(rootReducer, {}, enhancer);\n\nsagaMiddleware.run(downloadFormRequestedSaga);\n","import XLSX from 'xlsx';\n\nimport store from './store';\n\nexport default async function(fileUrl) {\n\n      var reader = new FileReader();\n      var fileBlob = await fetch(fileUrl);\n      fileBlob = await fileBlob.blob();\n\n      reader.onload = function(e) {\n        console.log(e)\n\n        var data = e.target.result;\n        var workbook = XLSX.read(data, {\n          type: 'binary'\n        });\n\n        // workbook.SheetNames.forEach(function(sheetName) {\n        //   // Here is your object\n        //   var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);\n        //   var json_object = JSON.stringify(XL_row_object);\n        // })\n        store.dispatch({type:'WORKBOOK_IMPORT_SUCCESS', payload:workbook});\n      };\n\n      reader.onerror = function(ex) {\n        store.dispatch({type:'WORKBOOK_IMPORT_FAIL', payload:ex});\n      };\n\n\n      reader.readAsBinaryString(fileBlob);\n\n  };\n","import React, { Component } from 'react';\nimport { Provider } from 'react-redux';\n\nimport {MuiThemeProvider} from '@material-ui/core/styles/'\nimport theme from './theme';\nimport TextileForm from './components/TextileForm';\n\nimport store from './store';\n\nimport ExcelToJSON from './ExcelToJSON';\n\n\n\nclass App extends Component {\n  componentWillMount(){\n     ExcelToJSON('./data/Price grids.xlsx');\n\n  }\n  render() {\n    return (\n      <Provider store={store}>\n        <MuiThemeProvider theme={theme}>\n          <TextileForm />\n        </MuiThemeProvider>\n      </Provider>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}